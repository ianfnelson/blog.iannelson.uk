<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>SQLServer on Ian Nelson</title>
    <link>https://blog.iannelson.uk/tags/sqlserver/</link>
    <description>Recent content in SQLServer on Ian Nelson</description>
    <generator>Hugo -- 0.146.6</generator>
    <language>en</language>
    <lastBuildDate>Sun, 04 May 2025 18:45:00 +0100</lastBuildDate>
    <atom:link href="https://blog.iannelson.uk/tags/sqlserver/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>SQL Server Point-in-Time Restore</title>
      <link>https://blog.iannelson.uk/sql-server-point-in-time-restore/</link>
      <pubDate>Fri, 23 Jan 2009 14:01:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/sql-server-point-in-time-restore/</guid>
      <description>&lt;p&gt;One of the multiple hats that I’m currently wearing for a client is that of SQL Server DBA. In this guise, I have recently fielded a couple of email queries from users concerned about the data recovery options available to them, should application data be inadvertently deleted:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“What kind of database backup and restore mechanism is in place for [application]? If someone deletes any data from [application] front end is it possible to restore it? Generally the way to recover data would be to restore the database from a database backup file, however this would restore all data held in the backup and would overwrite any changes made since the time of the backup.”&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>One of the multiple hats that I’m currently wearing for a client is that of SQL Server DBA. In this guise, I have recently fielded a couple of email queries from users concerned about the data recovery options available to them, should application data be inadvertently deleted:</p>
<blockquote>
<p>“What kind of database backup and restore mechanism is in place for [application]? If someone deletes any data from [application] front end is it possible to restore it? Generally the way to recover data would be to restore the database from a database backup file, however this would restore all data held in the backup and would overwrite any changes made since the time of the backup.”</p></blockquote>
<p>and</p>
<blockquote>
<p>“If user A corrupts data entry in some way, and needs to go back to a version X of the database before the corruption, will user B also have to go back to version X and potentially lose any ‘good’ they themselves might have added since version X?”</p></blockquote>
<p>I replied explaining that this is one of the many reasons for choosing SQL Server to provide the database back-end for critical applications, rather than, say, Access (don’t get me started on the prevalence of Access in mission-critical applications, it’s a bit of a bugbear).</p>
<p>If you have your SQL database recovery model set to Full or Bulk-Logged (and if not, why not?) then it is possible to <a href="http://www.microsoft.com/technet/prodtechnol/sql/2000/maintain/sqlbackuprest.mspx#ET2AE">restore from transaction log backups to a point in time</a>. So, in a data loss scenario like those outlined in the emails above, you would take a backup of the transaction log, and restore a <strong>new copy</strong> of the database to a point in time just before the deletion. The missing data could then be copied from the restored copy across to the live database. Easy.</p>
<p>Even so, just because this functionality exists doesn’t mean you should plan to use it. Flipping back to my system developer persona makes me question why the application allows users to perform non-logged hard deletes? Soft deletes would be far preferable (i.e. setting a “deleted” bit on the relevant rows). Better still are ledgering systems (like the bank statement paradigm), which handle updates and deletions by making a change entry, or entering an offsetting transaction.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Inside Microsoft SQL Server 2005: The Storage Engine</title>
      <link>https://blog.iannelson.uk/inside-microsoft-sql-server-2005-the-storage-engine/</link>
      <pubDate>Sat, 05 Jan 2008 21:01:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/inside-microsoft-sql-server-2005-the-storage-engine/</guid>
      <description>&lt;p&gt;During 2007, I unexpectedly achieved a long-held ambition by increasing the number of books I regularly read (as opposed to merely buying, then leaving them to languish on the bookcase!). I read plenty of techie books of course, but also made use of local libraries and devoured plenty of books on other subjects, and even found time for some fiction. I think having a young baby in the house was partially responsible for this achievement – not much else to do of an evening any more!&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>During 2007, I unexpectedly achieved a long-held ambition by increasing the number of books I regularly read (as opposed to merely buying, then leaving them to languish on the bookcase!). I read plenty of techie books of course, but also made use of local libraries and devoured plenty of books on other subjects, and even found time for some fiction. I think having a young baby in the house was partially responsible for this achievement – not much else to do of an evening any more!</p>
<p>Some books were great and will remain on my shelves for years to come. Plenty others were quickly returned to the libraries, or resold on Amazon Marketplace. Either way, I figure that it might be a nice addition to the old blog if I take the time to say a few words about some of them, so let’s start with the book I’ve finished most recently.</p>
<p><em>Inside Microsoft SQL Server 2005: The Storage Engine</em> by Kalen Delaney is one in a series of four books from MS Press, the other three having subtitles of <em><a href="http://www.amazon.co.uk/gp/product/0735621977?ie=UTF8&amp;tag=ianesbl-21&amp;linkCode=as2&amp;camp=1634&amp;creative=6738&amp;creativeASIN=0735621977">T-SQL Programming</a>, <a href="http://www.amazon.co.uk/gp/product/0735623139?ie=UTF8&amp;tag=ianesbl-21&amp;linkCode=as2&amp;camp=1634&amp;creative=6738&amp;creativeASIN=0735623139">T-SQL Querying</a>,</em> and <em><a href="http://www.amazon.co.uk/gp/product/0735621969?ie=UTF8&amp;tag=ianesbl-21&amp;linkCode=as2&amp;camp=1634&amp;creative=6738&amp;creativeASIN=0735621969">Query Tuning and Optimization</a></em>. I suspect that <em>The Storage Engine</em> is the most deep and esoteric of the four volumes, offering an insight into the architecture and inner workings of SQL Server that isn’t matched even by my old favourite <em><a href="https://blog.iannelson.uk/sql-2005-unleashed/">SQL Server 2005 Unleashed</a>.</em></p>
<p>By no stretch of the imagination could this be considered an introduction to SQL Server, and frequently I found myself skipping forward a few pages at a time, reasoning to myself that “there is no reason why I will ever need to know this!” – indeed, plenty of the first half of the book on topics such as architecture, configuration, files, logging, and recovery, would be of more use to DBAs and sysadmins rather than developers such as myself – not that it isn’t nice to have an appreciation of these topics though.</p>
<p>From a developer perspective, it is the second half where this book really springs to life, with three great chapters on Tables, Indexes, and Locking &amp; Concurrency. These are 235 pages of pure gold, offering to the willing reader a really <em>deep</em> understanding of what is really going on under the hood, and how exactly MSSQL goes about implementing your requests. It certainly blew apart some of my incorrect assumptions about internal table structures, and has given me a better understanding of the internal structures of clustered and nonclustered indexes.</p>
<p>SQL Server is one of the most widely used products in Microsoft’s server range, and in my opinion also one of the most widely abused. Anyone who has worked in this industry for any length of time has inevitably witnessed some awful database designs (no primary keys? no foreign keys? no indexes? every column a varchar(50)? you know the kind of thing!), but we can all learn to improve our database designs, and the level of understanding offered by Kalen’s book should help in the quest for perfection.</p>
<p>As long as my career keeps its technical focus, and I’m using SQL Server 2005, then this one is a keeper, and I’ve already ordered Kalen’s other book in the series, <em><a href="http://www.amazon.co.uk/gp/product/0735621969?ie=UTF8&amp;tag=ianesbl-21&amp;linkCode=as2&amp;camp=1634&amp;creative=6738&amp;creativeASIN=0735621969">Query Tuning and Optimization</a></em>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>SQL 2005 Unleashed</title>
      <link>https://blog.iannelson.uk/sql-2005-unleashed/</link>
      <pubDate>Fri, 18 May 2007 06:05:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/sql-2005-unleashed/</guid>
      <description>&lt;p&gt;Many moons (and about four jobs) ago, a wise DBA by the name of David Hanson once recommended to me a book called &lt;a href=&#34;http://www.amazon.co.uk/gp/product/0672324679?ie=UTF8&amp;amp;tag=ianesbl-21&amp;amp;linkCode=as2&amp;amp;camp=1634&amp;amp;creative=6738&amp;amp;creativeASIN=0672324679&#34;&gt;Microsoft SQL Server 2000 Unleashed&lt;/a&gt;. I took his advice, bought a copy, and it rapidly became one of the most dog-eared and oft-thumbed computing books I have ever owned. It is comprehensive, deep, broad, well-written and covers everything one might ever wish to know about SQL Server 2000. With its help and guidance I came to love and respect Microsoft’s premier database product, passing the &lt;a href=&#34;http://www.microsoft.com/learning/exams/70-229.mspx&#34;&gt;70-229 exam&lt;/a&gt; by a comfortable margin.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Many moons (and about four jobs) ago, a wise DBA by the name of David Hanson once recommended to me a book called <a href="http://www.amazon.co.uk/gp/product/0672324679?ie=UTF8&amp;tag=ianesbl-21&amp;linkCode=as2&amp;camp=1634&amp;creative=6738&amp;creativeASIN=0672324679">Microsoft SQL Server 2000 Unleashed</a>. I took his advice, bought a copy, and it rapidly became one of the most dog-eared and oft-thumbed computing books I have ever owned. It is comprehensive, deep, broad, well-written and covers everything one might ever wish to know about SQL Server 2000. With its help and guidance I came to love and respect Microsoft’s premier database product, passing the <a href="http://www.microsoft.com/learning/exams/70-229.mspx">70-229 exam</a> by a comfortable margin.</p>
<p><img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2023/08/iStock_000002294861XSmall.jpg"></p>
<p>So, following the release of SQL Server 2005, I was hoping that SAMS would publish a similar tome about that new platform. Once said book was announced, I pre-ordered <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>  a copy, and I’m delighted to report that after many months of patient waiting, the sequel (sorry) landed on my desk last week – and for a computing book, it’s simply awesome.</p>
<p><a href="http://www.amazon.co.uk/gp/product/0672328240?ie=UTF8&amp;tag=ianesbl-21&amp;linkCode=as2&amp;camp=1634&amp;creative=6738&amp;creativeASIN=0672328240">Microsoft SQL Server 2005 Unleashed</a> is even bigger than it’s predecessor. In fact, it’s so large that eight chapters have been left out of the physical book, and are included only in a PDF version supplied on CD-ROM. These aren’t just padding or filler, either – they’re solid chapters on interesting topics as Notification Services, Service Broker, Recovery Planning, and T-SQL Tips n Tricks. Including the bonus chapters, the whole package weighs in at over 2,000 pages – no wonder I had to wait a while for its publication!</p>
<p>I think you would be hard-pressed to find any other single SQL 2005 book which covers quite so much material to such depth. While perhaps not being suitable for beginners, for those with some experience of SQL Server or other relational database products, this book works on many levels – reference, tutorial, guidance, or just as an interesting read. If you work with, or anticipate working with, SQL 2005, then you owe it to yourself to get a copy now!</p>
<hr>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>I hate this term, but that’s what Amazon call it – “pre-order”. Whilst I understand the implication, I don’t think there’s any real linguistic difference between “ordering” and “pre-ordering”. Even less so the distinction between to “book” and to “pre-book”, a service offered by some cinemas…&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></content:encoded>
    </item>
    <item>
      <title>SQL Server Best Practices Analyser Tool</title>
      <link>https://blog.iannelson.uk/sql-server-best-practices-analyser-tool/</link>
      <pubDate>Sun, 12 Dec 2004 19:12:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/sql-server-best-practices-analyser-tool/</guid>
      <description>&lt;p&gt;Via &lt;a href=&#34;http://ericgharrison.com/Blog/archive/2004/12/11/491.aspx&#34;&gt;Eric G. Harrison&lt;/a&gt; – MS have developed a &lt;a href=&#34;http://www.microsoft.com/downloads/details.aspx?FamilyId=B352EB1F-D3CA-44EE-893E-9E07339C1F22&amp;amp;displaylang=en&#34;&gt;SQL Server Best Practices Analyser Tool&lt;/a&gt;. It’s like a cross between &lt;a href=&#34;http://www.gotdotnet.com/team/fxcop/&#34;&gt;FxCop&lt;/a&gt; and &lt;a href=&#34;http://www.microsoft.com/technet/security/tools/mbsahome.mspx&#34;&gt;Baseline Security Analyser&lt;/a&gt;, for SQL Server. Very useful. I just downloaded it, ran it against some of my databases, and it made some useful suggestions. This could quickly become indispensable.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Via <a href="http://ericgharrison.com/Blog/archive/2004/12/11/491.aspx">Eric G. Harrison</a> – MS have developed a <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=B352EB1F-D3CA-44EE-893E-9E07339C1F22&amp;displaylang=en">SQL Server Best Practices Analyser Tool</a>. It’s like a cross between <a href="http://www.gotdotnet.com/team/fxcop/">FxCop</a> and <a href="http://www.microsoft.com/technet/security/tools/mbsahome.mspx">Baseline Security Analyser</a>, for SQL Server. Very useful. I just downloaded it, ran it against some of my databases, and it made some useful suggestions. This could quickly become indispensable.</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
