<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>.NET on Ian Nelson</title>
    <link>https://blog.iannelson.uk/tags/.net/</link>
    <description>Recent content in .NET on Ian Nelson</description>
    <generator>Hugo -- 0.146.6</generator>
    <language>en</language>
    <lastBuildDate>Sun, 04 May 2025 17:45:45 +0100</lastBuildDate>
    <atom:link href="https://blog.iannelson.uk/tags/.net/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Alt.Net UK In The North</title>
      <link>https://blog.iannelson.uk/alt-net-uk-in-the-north/</link>
      <pubDate>Sun, 19 Apr 2009 20:04:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/alt-net-uk-in-the-north/</guid>
      <description>&lt;p&gt;I spent much of this weekend over in Bradford, talking shop with the good folks at the Alt.Net UK ‚Äòin the North‚Äô conference. I had a great time, learned much, and am grateful to &lt;a href=&#34;http://blogs.blackmarble.co.uk/blogs/rfennell/&#34;&gt;Richard Fennell&lt;/a&gt; of &lt;a href=&#34;http://www.blackmarble.co.uk/&#34;&gt;Black Marble&lt;/a&gt; and the other organisers and sponsors for making the event possible.&lt;/p&gt;
&lt;p&gt;This was the first &lt;a href=&#34;https://en.wikipedia.org/wiki/Open_Space_Technology&#34;&gt;Open Spaces&lt;/a&gt; event I‚Äôve attended, and I was pleasantly surprised at how orderly and productive the sessions turned out to be. Unlike conventional sales-pitch conferences of the MSDN roadshow variety, this was more of an open forum, with an expectation that all of the relatively small number (25ish?) of participants would, well, &lt;em&gt;participate&lt;/em&gt;!&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>I spent much of this weekend over in Bradford, talking shop with the good folks at the Alt.Net UK ‚Äòin the North‚Äô conference. I had a great time, learned much, and am grateful to <a href="http://blogs.blackmarble.co.uk/blogs/rfennell/">Richard Fennell</a> of <a href="http://www.blackmarble.co.uk/">Black Marble</a> and the other organisers and sponsors for making the event possible.</p>
<p>This was the first <a href="https://en.wikipedia.org/wiki/Open_Space_Technology">Open Spaces</a> event I‚Äôve attended, and I was pleasantly surprised at how orderly and productive the sessions turned out to be. Unlike conventional sales-pitch conferences of the MSDN roadshow variety, this was more of an open forum, with an expectation that all of the relatively small number (25ish?) of participants would, well, <em>participate</em>!</p>
<p>I was also surprised to find that there were more pragmatists in attendance than architecture astronauts. Maybe it‚Äôs a reflection of the current economic climate, but a common theme was on finding toolings that were <em>good enough</em> with which to deliver suitable solutions quickly and effectively, rather than striving for architectural purity and perfection.</p>
<p>It was great to hear some war stories, and learn about technologies, tools, methodologies and ideas that are currently exciting other people. It would be difficult to come away from a weekend like this one without some inspiration and a big list of several things to follow up on. Here‚Äôs mine:</p>
<ul>
<li><strong><a href="http://www.asp.net/mvc/">MVC Framework</a></strong> ‚Äì like myself, a lot of the attendees have had enough of the WebForms model, and are excited about the potential of ASP.NET MVC.</li>
<li><strong><a href="http://fluentnhibernate.org/">Fluent NHibernate</a></strong> ‚Äì it sounds like the project being feverishly worked on by <a href="http://blog.jagregory.com/">James Gregory</a> et al is ready for prime time. People spoke very positively of the ability to ditch XML HBM files in favour of this strongly-typed configuration.</li>
<li><strong><a href="http://www.balsamiq.com/">Balsamiq Mockups</a></strong> ‚Äì loved by everyone, even despite (or should that be because of?) its use of Comic Sans MS!</li>
<li><strong>Inversion of Control</strong> ‚Äì there was a wide mix of IoC containers being used. I‚Äôve tried <a href="http://www.castleproject.org/container/index.html">Castle Windsor</a>, other people made positive murmurings about <a href="http://msdn.microsoft.com/en-us/library/cc468366.aspx">Unity</a> and <a href="http://structuremap.sourceforge.net/Default.htm">StructureMap</a>.</li>
<li><strong><a href="http://www.typemock.com">TypeMock Isolator</a></strong> ‚Äì apparently capable of mocking the unmockable.</li>
<li><strong><a href="http://www.amazon.co.uk/gp/product/0123740371?ie=UTF8&amp;tag=ianesbl-21&amp;linkCode=as2&amp;camp=1634&amp;creative=19450&amp;creativeASIN=0123740371">Sketching User Experiences</a></strong> ‚Äì everyone who‚Äôd heard of him spoke highly of Bill Buxton‚Äôs work.</li>
<li><strong><a href="http://www.openquarters.org">Open Quarters CMS</a></strong> ‚Äì a great demonstration of a CMS built on ASP.NET MVC by <a href="http://www.anthonymain.com/">Anthony Main</a> and Andrew Magee. I look forward to taking a squizz at the source, I‚Äôm sure it will be an excellent learning aid.</li>
<li><strong><a href="http://sourceforge.net/projects/ulti-swat">SWAT</a></strong> ‚Äì a web testing tool developed by some folks at Ultimate Software and released on Sourceforge as an open source project (thanks to <a href="http://mckennatribe.com/">Nick</a> for the link).</li>
<li><strong>Wild Blue Yonder</strong> ‚Äì a delicious amber ale from Oregon which was on tap at the Sir Titus Salt pub, to where we decamped after the planning session on Friday night. Yum!</li>
</ul>
<p>I‚Äôm probably forgetting some things, there was a lot to take in, and I regret not having a pad of paper on hand. Hopefully my memory will be jogged by the blog postings of the other attendees.</p>
<p>Thanks again to all who made it possible, and all the attendees for quality the chat and inspiration.</p>
]]></content:encoded>
    </item>
    <item>
      <title>ASP.NET Just Became a Legacy Platform</title>
      <link>https://blog.iannelson.uk/asp-net-just-became-a-legacy-platform/</link>
      <pubDate>Sun, 22 Mar 2009 21:03:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/asp-net-just-became-a-legacy-platform/</guid>
      <description>&lt;p&gt;One of the least surprising but more significant announcements to come out of &lt;a href=&#34;http://live.visitmix.com/&#34;&gt;Mix ‚Äò09&lt;/a&gt; last week was the general availability of &lt;a href=&#34;http://www.asp.net/mvc/&#34;&gt;ASP.NET MVC 1.0&lt;/a&gt;. The development process for this framework has been very transparent, with no fewer than eight previews, betas and release candidates made available over the past year or so.&lt;/p&gt;
&lt;p&gt;Microsoft are being careful to tout ASP.NET MVC as being ‚Äúan alternative, not a replacement, for ASP.NET Web Forms‚Äù, but just look at their list of some of its benefits:&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>One of the least surprising but more significant announcements to come out of <a href="http://live.visitmix.com/">Mix ‚Äò09</a> last week was the general availability of <a href="http://www.asp.net/mvc/">ASP.NET MVC 1.0</a>. The development process for this framework has been very transparent, with no fewer than eight previews, betas and release candidates made available over the past year or so.</p>
<p>Microsoft are being careful to tout ASP.NET MVC as being ‚Äúan alternative, not a replacement, for ASP.NET Web Forms‚Äù, but just look at their list of some of its benefits:</p>
<ul>
<li>Clear separation of concerns</li>
<li>Testability ‚Äì support for Test-Driven Development</li>
<li>Fine-grained control over HTML and JavaScript</li>
<li>Intuitive URLs</li>
</ul>
<p>Which begs the question ‚Äì if you were kicking off development of a new web-based application on the Microsoft platform today, why would you even consider using Web Forms? Surely the choice now boils down to Silverlight or ASP.NET MVC? I fully expect that, by the time the summer Olympics come to London, Web Forms will be considered to be a legacy platform, with job adverts referring to it as ‚Äú<em>Classic ASP.NET</em>‚Äù.</p>
<p>And that‚Äôs probably no bad thing. Sure, for those of us who lived through the static web, CGI forms and classic ASP, ASP.NET was a godsend, with its cunning state management techniques, custom controls, and page lifecycle events. But, even in the hands of decent developers, it does tend to promote a magic pushbutton anti-pattern, with untestable business logic frequently dumped in the code-behind. So, as a fanboy of OOP, TDD, and Separation of Concerns, this eventual release of ASP.NET MVC comes as a source of great pleasure to me, and means that I can look forward to many more years of enjoyably developing web apps on the MS platform.</p>
<p>But hang on a cotton-picking minute ‚Äì what exactly is truly new, here? Haven‚Äôt we been able to do MVC development on the MS platform for years, using <a href="http://www.castleproject.org/MonoRail/">Castle Monorail</a>? Well, yes we have ‚Äì I had the pleasure of using it last summer when developing systems for <a href="http://www.cmoptions.org/">Child Maintenance Options</a>. And Monorail itself was inspired by <a href="http://api.rubyonrails.org/">Ruby on Rails</a>, and the J2EE platform has had <a href="http://struts.apache.org/">Apache Struts</a> for donkey‚Äôs years (I used it briefly in the summer of 2002 when developing systems for <a href="http://www.three.co.uk">Three</a>).</p>
<p>So, if we could do this stuff already, even on the ASP.NET platform, why does the release of ASP.NET MVC still matter so much?</p>
<p>The slightly depressing but inevitable truth is that it matters because it‚Äôs a product which has been developed by and will be fully supported by Microsoft. To many organisations, that‚Äôs reason enough to use it when they would have never in a month of Sundays considered using the likes of Monorail.</p>
<p>As a crude indicator of popularity, consider the questions posted on <a href="http://stackoverflow.com/">Stack Overflow</a> to date. 1819 of them have been tagged ‚ÄúASP.NET-MVC‚Äù, whilst a mere 22 have been tagged ‚ÄúMonorail‚Äù or ‚ÄúCastle-Monorail‚Äù.</p>
<p>The same can be seen of many other modern technologies used in the development of custom applications. Take <a href="http://en.wikipedia.org/wiki/Object-relational_mapping">ORM</a> for example ‚Äì <a href="http://www.hibernate.org/343.html">NHibernate</a> has been around for, what, around six years or so since it was originally ported from <a href="http://www.hibernate.org/">Hibernate</a> (I seem to have <a href="https://blog.iannelson.uk/nhibernate/">first mentioned it on this blog in 2004</a>). But the traction that <a href="http://msdn.microsoft.com/en-us/library/bb386976.aspx">LINQ to SQL</a> and <a href="http://msdn.microsoft.com/en-us/library/bb399572.aspx">Entity Framework</a> have garnered in their short existence has already almost outstripped the popularity of NHibernate by some metrics.</p>
<p>Entity Framework, while not to everyone‚Äôs taste, at least has the potential to offer something quite different and distinct from NHibernate. But the same can‚Äôt be said of some other recent examples of Microsoft‚Äôs ongoing <a href="http://en.wikipedia.org/wiki/Embrace,_extend_and_extinguish">Embrace, Extend and Extinguish</a> policy ‚Äì what does Visual Studio Unit Testing offer that <a href="http://www.nunit.org/index.php">NUnit</a> didn‚Äôt? Why develop the <a href="http://msdn.microsoft.com/en-us/library/cc468366.aspx">Unity Application Block</a> in a universe that already contains <a href="http://www.castleproject.org/container/index.html">Castle Windsor</a> and a plethora of other <a href="http://en.wikipedia.org/wiki/Inversion_of_Control">IoC</a> containers? How long will it be before Microsoft write their own <a href="http://en.wikipedia.org/wiki/Mock_object">mock object</a> framework? Surely they will eventually do so, to meet the demands of the large proportion of dev shops that simply won‚Äôt touch none-MS tooling.</p>
<p>Why this should be the case, I can‚Äôt really say, but as a freelance developer I‚Äôve seen it with my own eyes ‚Äì working with organisations with technical strategies that specify the use of Microsoft technologies wherever possible, and shun the adoption of open source or third-party solutions. I hear people say ‚Äúwe‚Äôll wait for Entity Framework to mature, rather than trying NHibernate‚Äù, and I see the funny stares people give me when I meekly suggest that we use <a href="http://www.codeplex.com/xunit">xUnit.Net</a> or <a href="http://code.google.com/p/moq/">Moq</a> on a project.</p>
<p><img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2023/08/iStock_000004857675XSmall_3.jpg"></p>
<p>So, perhaps we can‚Äôt entirely blame Microsoft. True, their practices do sometimes feel to be anti-competitive and limiting of choice. But they are a business after all, and are merely meeting the demands of their customers.</p>
<p>And is it really in my best interests to complain about these practices? I am a freelance developer and Microsoft registered partner and have to be pragmatic about this. I am in business developing custom applications for the Microsoft platform, and in doing so I want to use 21st-century techniques such as ORM, the MVC pattern, unit testing, mocking, IoC, etc. If my clients are more likely to be receptive to those concepts if there exists a suitable Microsoft implementation, then so be it. But please, let me continue using NHibernate instead of Entity Framework‚Ä¶</p>
<p>ASP.NET RIP. Long live ASP.NET MVC.</p>
]]></content:encoded>
    </item>
    <item>
      <title>NDepend</title>
      <link>https://blog.iannelson.uk/ndepend/</link>
      <pubDate>Wed, 04 Feb 2009 15:02:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/ndepend/</guid>
      <description>&lt;p&gt;OK, dear readers, today I‚Äôd like to talk about tools.&lt;/p&gt;
&lt;p&gt;Software development isn‚Äôt really so different from traditional skilled crafts in that it is important to have an understanding of the tools available to help you create a quality products in the least amount of time possible.&lt;/p&gt;
&lt;p&gt;For .NET developers, the Visual Studio IDE is usually just the starting point, and most of us will come to rely on some of the tools listed in Scott Hanselman‚Äôs famous &lt;a href=&#34;http://www.hanselman.com/tools&#34;&gt;tools list&lt;/a&gt;. Personally, I can‚Äôt imagine coding without first installing &lt;a href=&#34;http://www.devexpress.com/refactor&#34;&gt;Refactor Pro&lt;/a&gt;, editing text files in anything other than &lt;a href=&#34;http://www.textpad.com&#34;&gt;TextPad&lt;/a&gt;, or working on a machine that doesn‚Äôt have Snag It installed.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>OK, dear readers, today I‚Äôd like to talk about tools.</p>
<p>Software development isn‚Äôt really so different from traditional skilled crafts in that it is important to have an understanding of the tools available to help you create a quality products in the least amount of time possible.</p>
<p>For .NET developers, the Visual Studio IDE is usually just the starting point, and most of us will come to rely on some of the tools listed in Scott Hanselman‚Äôs famous <a href="http://www.hanselman.com/tools">tools list</a>. Personally, I can‚Äôt imagine coding without first installing <a href="http://www.devexpress.com/refactor">Refactor Pro</a>, editing text files in anything other than <a href="http://www.textpad.com">TextPad</a>, or working on a machine that doesn‚Äôt have Snag It installed.</p>
<h2 id="mri-for-your-net-application">MRI For Your .NET Application</h2>
<p>Another one of the tools that I reach for frequently, and the subject of this blog post, is <strong><a href="http://www.ndepend.com">NDepend</a></strong>, which performs rapid static analysis of a set of .NET assemblies and provides a deliciously visual interface for interpreting and understanding the results. Through the use of this tool, architects and developers can quickly spot problems or potential areas for improvements in a codebase. It‚Äôs essentially an MRI Scanner for your .NET code!</p>
<p><img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2023/08/iStock_000004593967XSmall_2.jpg"></p>
<h2 id="so-what-does-it-do">So.. What Does It Do?</h2>
<p>I‚Äôve briefly mentioned my use of NDepend before ‚Äì for example I <a href="https://blog.iannelson.uk/msb3247-dependent-assembly-conflicts/">blogged in December</a> about how I was able to use NDepend to resolve an MSB3247 compiler warning which a developer was experiencing. But there‚Äôs much more to it than just helping solve simple assembly reference problems. Some of my favourite features include:</p>
<p>An interactive <strong>Dependency Graph</strong>, giving a visual representation of the relationships between assemblies (both within your application, and any third-party and system dependencies). Here‚Äôs an example output from analysing the S#arp Architecture project:</p>
<p><img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2023/08/DependencyGraphSnapshot.png"></p>
<p>The <strong>Dependency Matrix</strong> cross-tabulates all the references between assemblies, allowing for drilling down to member level. Remember all those dictats you issued to the dev team in your coding standards, such as ‚Äúdon‚Äôt reference the data layer from the front-end‚Äù? Well, this is the window you‚Äôll use for ensuring that the team are abiding by such rules. Usefully, cyclical references between namespaces are particularly highlighted.</p>
<p><img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2023/08/NDependMatrix_2.png"></p>
<p>The <strong>Metrics Window</strong> is where I tend to spend most of my time, using the inbuilt CQL (Code Query Language) to identify areas of the codebase which are ripe for refactoring. This area of the tool is like FxCop on steroids.</p>
<p><img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2023/08/NDependMetrics_2.png"></p>
<p>I‚Äôm also a big fan of the <strong>Changes Explorer</strong> functionality, which highlights at a glance the changes made between any two builds of an application. Also the ability to import <strong>Code Coverage</strong> files from NCover or Visual Studio Team System, to similarly highlight the areas of a solution which are adequately covered by <a href="https://blog.iannelson.uk/12-reasons-why-i-love-unit-tests/">unit tests</a>.</p>
<h2 id="real-world-benefits">Real-World Benefits</h2>
<p>NDepend is useful when looking at your own code, but really comes into its own when you want to quickly grok a codebase developed by someone else. Here‚Äôs an example:</p>
<p>My current client have the IP rights to a bespoke .NET application which has been developed for them by a third party. They plan to bring the development of this application in house, and recently asked me to take a look through the source and feed back my thoughts on the architecture.</p>
<p>Initially, I made the mistake of doing this code review solely by looking at the code itself, through the IDE. I was impressed ‚Äì the code was exceedingly clean, the solution well-structured, and everything looked very straightforward. The object model was mapped to the database using <a href="https://blog.iannelson.uk/on-the-joys-of-object-relational-mapping/">NHibernate</a>, which in turn was abstracted from the appliation code by a standard DAO pattern. So far so good, and I was about to email a thumbs-up.</p>
<p>But I smelled a rat ‚Äì the code was almost too clean, and I couldn‚Äôt find the actual meat of the business logic. So, I whipped out NDepend (which I really should have done initially), ran an analysis, and realised that the cleanliness and simplicity of the middle tier was due to over two-thirds of the solution logic existing in the user interface layer! In fact 28% of the IL instructions from the entire solution were contained in the code-behind of just three web pages. It was a classic example of the <a href="http://en.wikipedia.org/wiki/Magic_pushbutton">magic pushbutton anti-pattern</a>, and I very nearly failed to spot it.</p>
<h2 id="tmi">TMI?</h2>
<p>If I had to identify a drawback to NDepend, it is the risk that much of the output information may be meaningless to the average .NET developer. Returning to my earlier medical analogies, an X-Ray or MRI Scan is useless in itself until it is viewed by a medical professional with the knowledge and experience to interpret the results.</p>
<p><img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2023/08/iStock_000005830514XSmall_2-1.jpg"></p>
<p>This potential problem is somewhat alleviated by the explanatory videos, <a href="http://codebetter.com/blogs/patricksmacchia/">Patrick‚Äôs extensive blogging</a>, and indeed the range of predefined CQL queries which serve to interpret the results and highlight potential problems. Even so, I suspect NDepend is more likely to be found in the toolkit of the architect or lead developer rather than the hobbyist ‚Äì especially given the EUR 299 price tag for a professional license.</p>
<h2 id="final-thoughts">Final Thoughts</h2>
<p>To summarise, NDepend provides a short-cut to quickly understanding a .NET codebase and identifying potential improvements. If the quality of your code is important to you, or you frequently have to review code developed by other people, then I think you‚Äôll find NDepend to be indispensable.</p>
<p><em>Disclaimer: Ian Nelson was provided with a complementary review copy of NDepend Professional version 2.0, and has subsequently paid for later editions of the software.</em></p>
]]></content:encoded>
    </item>
    <item>
      <title>.NET Coding Standards</title>
      <link>https://blog.iannelson.uk/net-coding-standards/</link>
      <pubDate>Fri, 23 Jan 2009 15:01:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/net-coding-standards/</guid>
      <description>&lt;p&gt;Sometimes, when you join a new team as a .NET developer, the team lead proudly points you in the direction of a Word document or wiki page detailing the team‚Äôs house coding standards.&lt;/p&gt;
&lt;p&gt;In my experience, these documents are invariably:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Incomplete.&lt;/li&gt;
&lt;li&gt;Subjective.&lt;/li&gt;
&lt;li&gt;Not enforced.&lt;/li&gt;
&lt;li&gt;Largely copied from the interweb.&lt;/li&gt;
&lt;li&gt;Obsessed with the trivial (e.g. whitespace) while failing to mention the genuinely useful (e.g. boxing/unboxing, avoiding use of deprecated classes, Dispose pattern, etc).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I know this because I‚Äôve been involved in creating such documents in the past üôÇ&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Sometimes, when you join a new team as a .NET developer, the team lead proudly points you in the direction of a Word document or wiki page detailing the team‚Äôs house coding standards.</p>
<p>In my experience, these documents are invariably:</p>
<ul>
<li>Incomplete.</li>
<li>Subjective.</li>
<li>Not enforced.</li>
<li>Largely copied from the interweb.</li>
<li>Obsessed with the trivial (e.g. whitespace) while failing to mention the genuinely useful (e.g. boxing/unboxing, avoiding use of deprecated classes, Dispose pattern, etc).</li>
</ul>
<p>I know this because I‚Äôve been involved in creating such documents in the past üôÇ</p>
<p>Don‚Äôt get me wrong, I‚Äôm all in favour of creating clean code, and promoting standards within a team. I just find that most in-house style guides fail to achieve this, for the reasons listed above.</p>
<p>So, as I was walking through the city today, I started having a little debate with myself. ‚ÄúOK then, smarty-pants. What‚Äôs your alternative? What would your in-house coding standards guidelines look like?‚Äù</p>
<p>I think it can be summarised by four simple points, listed in order of importance:</p>
<h2 id="1-dont-ignore-compiler-warnings">1. Don‚Äôt Ignore Compiler Warnings</h2>
<p>You might think this would be an obvious one, but I‚Äôve lost count of the number of times I‚Äôve retrieved a solution from source control, compiled it, and been presented with a list of compiler warnings. Most of the time, there‚Äôs no excuse for this. If the <em>compiler</em> smells a rat in your code, then you‚Äôve got a problem, be it variables that are used without being initialized, unused variables, unreachable code, or whatever. It‚Äôs sloppy code, and it‚Äôs easily avoided, so don‚Äôt leave it for the next guy to clean up. I am, if you hadn‚Äôt guessed, a big fan of setting the ‚Äútreat compiler warnings as errors‚Äù flag in a project‚Äôs build properties.</p>
<h2 id="2-follow-the-framework-design-guidelines">2. Follow the Framework Design Guidelines</h2>
<p>The <a href="http://www.amazon.co.uk/gp/product/0321545613?ie=UTF8&amp;tag=ianesbl-21&amp;linkCode=as2&amp;camp=1634&amp;creative=19450&amp;creativeASIN=0321545613">Framework Design Guidelines</a> is another one of those books whose name doesn‚Äôt do it justice. The sagely guidance it contains is appropriate not only to Microsofties developing the FCL itself, but to anyone writing any .NET code. Don‚Äôt let your developers near a copy of Visual Studio until they‚Äôve provided a sworn affidavit confirming that they‚Äôve read this book! üôÇ</p>
<p>All of the guidelines are concisely boiled down into Do, Consider, Avoid, and Do Not recommendations, and you would do well to adhere to these. Getting a few copies of this book for your team is a much more effective and cost-effective approach than trying to develop your own coding standards.</p>
<h2 id="3-run-fxcop">3. Run FxCop</h2>
<p>Having read and digested the Framework Design Guidelines, you need an easy way to enforce them. This is best achieved by running <a href="http://www.amazon.co.uk/gp/product/0321545613?ie=UTF8&amp;tag=ianesbl-21&amp;linkCode=as2&amp;camp=1634&amp;creative=19450&amp;creativeASIN=0321545613">FxCop</a> against your code (now integrated into some of the Visual Studio SKUs as a ‚ÄúCode Analysis‚Äù option).</p>
<p>Depending on the target audience for your solution, you may consider it reasonable to ignore some of the localization recommendations (i.e. when developing in-house line of business applications with limited geographical reach). But generally, if FxCop flags a warning in your code, I believe you would be well advised to correct the problem. Doing this helps to avoid a wide range of performance, security and design issues, in addition to enforcing consistent source code conventions.</p>
<h2 id="4-run-stylecop">4. Run StyleCop</h2>
<p>Finally, if you simply must achieve that uniform source code appearance that the whitespace Nazis in every team strive for, consider requiring that your devs run their code through <a href="http://code.msdn.microsoft.com/sourceanalysis">StyleCop</a> before checking in. It may initially be a bit annoying, and for sure some of the recommendations are highly subjective, but there‚Äôs no arguing that it does enforce a standard style, with a strong focus on increasing readability and reducing ambiguity.</p>
<h2 id="and-after-that">And After That‚Ä¶?</h2>
<p>Following the four points above should result in the low-level codebase produced by a team being readable, of high quality, in a common style, and free of many common ‚Äúgotchas‚Äù. It doesn‚Äôt validate the higher-level architectural considerations, but in my opinion that is outside the scope of such a document, and could best be achieved through the use of a tool such as <a href="https://blog.iannelson.uk/ndepend/">NDepend</a>. But that‚Äôs a topic for another post‚Ä¶</p>
]]></content:encoded>
    </item>
    <item>
      <title>MSB3247 ‚Äì Dependent Assembly Conflicts</title>
      <link>https://blog.iannelson.uk/msb3247-dependent-assembly-conflicts/</link>
      <pubDate>Thu, 04 Dec 2008 21:12:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/msb3247-dependent-assembly-conflicts/</guid>
      <description>&lt;p&gt;Earlier today a dev came over to ask me about a compiler warning he was getting when building a .NET solution:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;MSB3247: Found conflicts between different versions of the same dependent assembly.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is basically telling you that one project or dependency in your solution is referencing one version of an assembly, whilst another project or dependency is trying to reference a different version of the same assembly. Unhelpfully, the message and build output don‚Äôt tell you &lt;em&gt;which&lt;/em&gt; dependent assembly is causing the problem!&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Earlier today a dev came over to ask me about a compiler warning he was getting when building a .NET solution:</p>
<blockquote>
<p>MSB3247: Found conflicts between different versions of the same dependent assembly.</p></blockquote>
<p>This is basically telling you that one project or dependency in your solution is referencing one version of an assembly, whilst another project or dependency is trying to reference a different version of the same assembly. Unhelpfully, the message and build output don‚Äôt tell you <em>which</em> dependent assembly is causing the problem!</p>
<p>To solve this, I reached for <a href="http://www.ndepend.com">NDepend</a> and tried to analyze the compiled assemblies. The conflicting assemblies were both excluded from the analysis and a warning message explained that this was a clash between two versions of System.Web.Extensions.dll ‚Äì 3.5.0.0 was being referenced by a Telerik UI control, and an earlier version was being used by the developer‚Äôs application. This kind of dependency clash is one potential drawback of relying too heavily on third-party controls.</p>
<p>I was going to suggest bringing the application up to date and referencing the newer dll, but a quick squizz at NDepend‚Äôs dependency graph revealed that the Telerik assembly wasn‚Äôt actually being used by the application at all, and nor were several other referenced components! Deleting the unused references left a slightly leaner, faster-compiling solution with zero build warnings.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Performance of Loops on Collections</title>
      <link>https://blog.iannelson.uk/performance-of-loops-on-collections/</link>
      <pubDate>Fri, 28 Nov 2008 12:11:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/performance-of-loops-on-collections/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://codebetter.com/blogs/patricksmacchia/archive/2008/11/19/an-easy-and-efficient-way-to-improve-net-code-performances.aspx&#34;&gt;Interesting article&lt;/a&gt; from &lt;a href=&#34;http://codebetter.com/blogs/patricksmacchia&#34;&gt;Patrick Smacchia&lt;/a&gt; (the &lt;a href=&#34;http://www.ndepend.com&#34;&gt;NDepend&lt;/a&gt; guy) in which he runs some benchmarks on the cost of looping in different ways over different constructs and comes to the conclusion that:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;‚Äúlooping on array using for is &lt;strong&gt;5 times cheaper&lt;/strong&gt; than looping on &lt;code&gt;List&amp;lt;T&amp;gt;&lt;/code&gt; using foreach (which I believe, is what we all do)‚Äù&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Well worth a read, although I suspect that in my solutions the bottlenecks will remain the out-of-process calls, i.e. database access and web service calls. Still, a 5x gain is not to be sniffed at.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p><a href="http://codebetter.com/blogs/patricksmacchia/archive/2008/11/19/an-easy-and-efficient-way-to-improve-net-code-performances.aspx">Interesting article</a> from <a href="http://codebetter.com/blogs/patricksmacchia">Patrick Smacchia</a> (the <a href="http://www.ndepend.com">NDepend</a> guy) in which he runs some benchmarks on the cost of looping in different ways over different constructs and comes to the conclusion that:</p>
<blockquote>
<p>‚Äúlooping on array using for is <strong>5 times cheaper</strong> than looping on <code>List&lt;T&gt;</code> using foreach (which I believe, is what we all do)‚Äù</p></blockquote>
<p>Well worth a read, although I suspect that in my solutions the bottlenecks will remain the out-of-process calls, i.e. database access and web service calls. Still, a 5x gain is not to be sniffed at.</p>
<p><a href="http://codebetter.com/blogs/patricksmacchia/archive/2008/11/19/an-easy-and-efficient-way-to-improve-net-code-performances.aspx">Patrick Smacchia ‚Äì An easy and efficient way to improve .NET code performance</a>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>A LINQ Gotcha ‚Äì First Operator</title>
      <link>https://blog.iannelson.uk/a-linq-gotcha-first-operator/</link>
      <pubDate>Fri, 14 Dec 2007 14:12:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/a-linq-gotcha-first-operator/</guid>
      <description>&lt;p&gt;So, I was using the &lt;code&gt;First&lt;/code&gt; operator to return the first item element in a sequence matching a predicate.&lt;/p&gt;
&lt;p&gt;I expected a null to be returned if the sequence did not contain any matching elements, but found (well, Scott found) that this actually throws an InvalidOperationException.&lt;/p&gt;
&lt;p&gt;Turns out I should have been using the &lt;code&gt;FirstOrDefault&lt;/code&gt; operator instead‚Ä¶&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>So, I was using the <code>First</code> operator to return the first item element in a sequence matching a predicate.</p>
<p>I expected a null to be returned if the sequence did not contain any matching elements, but found (well, Scott found) that this actually throws an InvalidOperationException.</p>
<p>Turns out I should have been using the <code>FirstOrDefault</code> operator instead‚Ä¶</p>
]]></content:encoded>
    </item>
    <item>
      <title>MSDN Technical Roadshow 2007</title>
      <link>https://blog.iannelson.uk/msdn-technical-roadshow-2007/</link>
      <pubDate>Mon, 12 Mar 2007 22:03:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/msdn-technical-roadshow-2007/</guid>
      <description>&lt;p&gt;I‚Äôm off to the &lt;a href=&#34;http://www.microsoft.com/uk/techroadshow2007/msdn/default.mspx&#34;&gt;MSDN Technical roadshow&lt;/a&gt; in Harrogate tomorrow, and am actually really looking forward to it this time. These events are free, so always well worth attending when they‚Äôre local, but some years are certainly better than others ‚Äì it mostly depends on the material being covered. I remember one year circa 2003-4, when .NET was well established, but before the Whidbey release, so the majority of the day was effectively just a sales pitch covering elementary .NET concepts, presumably for those laggards who hadn‚Äôt yet made the great leap from VB6. Another data-binding demo, anybody?  Yawn.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>I‚Äôm off to the <a href="http://www.microsoft.com/uk/techroadshow2007/msdn/default.mspx">MSDN Technical roadshow</a> in Harrogate tomorrow, and am actually really looking forward to it this time. These events are free, so always well worth attending when they‚Äôre local, but some years are certainly better than others ‚Äì it mostly depends on the material being covered. I remember one year circa 2003-4, when .NET was well established, but before the Whidbey release, so the majority of the day was effectively just a sales pitch covering elementary .NET concepts, presumably for those laggards who hadn‚Äôt yet made the great leap from VB6. Another data-binding demo, anybody?  Yawn.</p>
<p>By contrast, this time round there‚Äôs no shortage of exciting potential topics, and as I‚Äôve mentioned recently, I‚Äôve been having difficulty making time to get stuck into learning some of the new technologies that are on the horizon. So the opportunity of a day out watching some powerpoint presentations, demos, and trying to soak up an understanding of this stuff really appeals to me ‚Äì is that sad?!</p>
<p>The two sessions I‚Äôm most looking forward to are <a href="http://www.danielmoth.com/Blog/">Daniel Moth</a> covering LINQ and other forthcoming language enhancements in the Orcas release, and <a href="http://blogs.msdn.com/mikeormond/default.aspx">Mike Ormond</a>&rsquo;s session on AJAX development. Should be good.</p>
<p>Oh, entertainingly, someone found my blog this week by Googling for <a href="http://www.google.com/search?q=%22msdn&#43;event%22&#43;dress&#43;code&amp;">‚Äúmsdn event‚Äù dress code</a> ‚Äì my advice is to go casual; stick to the usual geek staples of t-shirt with jeans or combats and you can‚Äôt go far wrong!</p>
]]></content:encoded>
    </item>
    <item>
      <title>A Serializable KeyValuePair Class</title>
      <link>https://blog.iannelson.uk/a-serializable-keyvaluepair-class/</link>
      <pubDate>Sun, 17 Sep 2006 17:09:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/a-serializable-keyvaluepair-class/</guid>
      <description>&lt;p&gt;Having accepted that &lt;a href=&#34;http://www.hanselman.com/blog/ReturningDataSetsFromWebServicesIsTheSpawnOfSatanAndRepresentsAllThatIsTrulyEvilInTheWorld.aspx&#34;&gt;Returning DataSets from WebServices is the Spawn of Satan and Represents All That Is Truly Evil in the World&lt;/a&gt; (or at least, not exactly best practice), I‚Äôve been trying to make a conscious effort to instead use lightweight custom objects in my middle tier, to be exposed via web services for use by other applications. I felt sure that some of the new Generic classes in the .NET 2.0 FCL would help me in my quest. Specifically, as I often need to expose simple arrays of Key/Value Pair metadata, I planned to create an instance of the  &lt;code&gt;System.Collections.ObjectModel.Collection&lt;/code&gt; class, containing a bunch of &lt;code&gt;System.Collections.Generic.KeyValuePair&lt;/code&gt; objects.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Having accepted that <a href="http://www.hanselman.com/blog/ReturningDataSetsFromWebServicesIsTheSpawnOfSatanAndRepresentsAllThatIsTrulyEvilInTheWorld.aspx">Returning DataSets from WebServices is the Spawn of Satan and Represents All That Is Truly Evil in the World</a> (or at least, not exactly best practice), I‚Äôve been trying to make a conscious effort to instead use lightweight custom objects in my middle tier, to be exposed via web services for use by other applications. I felt sure that some of the new Generic classes in the .NET 2.0 FCL would help me in my quest. Specifically, as I often need to expose simple arrays of Key/Value Pair metadata, I planned to create an instance of the  <code>System.Collections.ObjectModel.Collection</code> class, containing a bunch of <code>System.Collections.Generic.KeyValuePair</code> objects.</p>
<p>Well, this all seemed to go to plan, and worked just fine within my app. But when I exposed the method as a web service, I discovered that neither the Key nor the Value properties were serialized ‚Äì I was left to consume a lovely generic collection of objects with no members ‚Äì not a whole lot of use.</p>
<p>A little Googling turned up <a href="http://blogs.msdn.com/seshadripv/archive/2005/11/02/488273.aspx">this blog entry</a>, which explains that the Key and Value properties on the KeyValuePair class are both read-only, and by design the XmlSerializer will not serialize properties that don‚Äôt have a set accessor!</p>
<p>Damned if that little matter was going to stop me, I whipped out my copy of Lutz Roeder‚Äôs reflector to reverse engineer the <code>KeyValuePair</code> class (to be honest, I could have guessed most of it), and added a <em>private</em> set accessor to both properties, thus persuading the XmlSerializer to, well, do some serializing üôÇ</p>
<p>Here‚Äôs the code for this new class:</p>



  

<script src="https://gist.github.com/ianfnelson/9862098.js?file=KeyValuePairThatSerializesProperly.cs"></script>
<p>Having done that, to add a little clarity when using this class in the way I anticipate and eliminate repeated code, I decided to create some specific versions of the <code>Collection</code>, <code>ReadOnlyCollection</code> and <code>KeyedCollection</code> classes:</p>



  

<script src="https://gist.github.com/ianfnelson/9862098.js?file=KeyValuePairCollection.cs"></script>



  

<script src="https://gist.github.com/ianfnelson/9862098.js?file=ReadOnlyKeyValuePairCollection.cs"></script>



  

<script src="https://gist.github.com/ianfnelson/9862098.js?file=KeyValuePairKeyedCollection.cs"></script>
]]></content:encoded>
    </item>
    <item>
      <title>Big Integer</title>
      <link>https://blog.iannelson.uk/big-integer/</link>
      <pubDate>Mon, 17 Jul 2006 08:07:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/big-integer/</guid>
      <description>&lt;p&gt;As I mentioned &lt;a href=&#34;https://blog.iannelson.uk/project-euler/&#34;&gt;last summer&lt;/a&gt;, I do enjoy whiling away a few hours attempting to solve the maths / progamming challenges set on &lt;a href=&#34;http://mathschallenge.net/index.php?section=project&#34;&gt;Project Euler&lt;/a&gt;. My language of choice for most puzzles is C#, but this hampered me on some of the questions as there is no in-built support for really big integers.&lt;/p&gt;
&lt;p&gt;However, a little bit of Googling and I came across this excellent &lt;a href=&#34;http://www.codeproject.com/csharp/biginteger.asp&#34;&gt;BigInteger class&lt;/a&gt; on Code Project which does everything I need and more ‚Äì and it seems bloody fast, too. Thanks to this class, I‚Äôve been able to knock off several more problems this weekend, and now have a rating of ‚Äú11% Genius‚Äù ‚Äì still some way to go, then‚Ä¶&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>As I mentioned <a href="https://blog.iannelson.uk/project-euler/">last summer</a>, I do enjoy whiling away a few hours attempting to solve the maths / progamming challenges set on <a href="http://mathschallenge.net/index.php?section=project">Project Euler</a>. My language of choice for most puzzles is C#, but this hampered me on some of the questions as there is no in-built support for really big integers.</p>
<p>However, a little bit of Googling and I came across this excellent <a href="http://www.codeproject.com/csharp/biginteger.asp">BigInteger class</a> on Code Project which does everything I need and more ‚Äì and it seems bloody fast, too. Thanks to this class, I‚Äôve been able to knock off several more problems this weekend, and now have a rating of ‚Äú11% Genius‚Äù ‚Äì still some way to go, then‚Ä¶</p>
]]></content:encoded>
    </item>
    <item>
      <title>Universal Comparer for .NET</title>
      <link>https://blog.iannelson.uk/universal-comparer-for-net/</link>
      <pubDate>Mon, 27 Feb 2006 22:02:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/universal-comparer-for-net/</guid>
      <description>&lt;p&gt;Back in November 2004, I had the idea of making a &amp;ldquo;&lt;a href=&#34;https://blog.iannelson.uk/a-generic-sorter-for-strongly-typed-collections/&#34;&gt;Generic Sorter for Strongly-Typed Collections&lt;/a&gt;&amp;rdquo;, by harnessing the mighty power of reflection. Well, earlier this month somebody anonymously emailed me some code that takes this to a whole different level, enabling sorting on multiple properties and to arbitrary depths within the domain model hierarchy, all by taking a single SQL-like parameter. It‚Äôs really very clever indeed, and I‚Äôm going to use this method in the future ‚Äì thanks, anonymous code fairy!&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Back in November 2004, I had the idea of making a &ldquo;<a href="https://blog.iannelson.uk/a-generic-sorter-for-strongly-typed-collections/">Generic Sorter for Strongly-Typed Collections</a>&rdquo;, by harnessing the mighty power of reflection. Well, earlier this month somebody anonymously emailed me some code that takes this to a whole different level, enabling sorting on multiple properties and to arbitrary depths within the domain model hierarchy, all by taking a single SQL-like parameter. It‚Äôs really very clever indeed, and I‚Äôm going to use this method in the future ‚Äì thanks, anonymous code fairy!</p>
<p>Oh, while I‚Äôm at it, I decided to rename the class, as the use of &ldquo;Generic&rdquo; could be confusing now we have the generic language feature in .NET 2.0. Also, this class doesn‚Äôt actually do the sorting, it just implements IComparer to do the comparing. So, with the help of a thesaurus, I settled on &ldquo;UniversalComparer&rdquo;!</p>



<script src="https://gist.github.com/ianfnelson/9861758.js"></script>
]]></content:encoded>
    </item>
    <item>
      <title>String.IsNullOrEmpty</title>
      <link>https://blog.iannelson.uk/string-isnullorempty/</link>
      <pubDate>Sat, 25 Feb 2006 14:02:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/string-isnullorempty/</guid>
      <description>&lt;p&gt;The single most popular entry on this blog is, surprisingly enough, this &lt;a href=&#34;https://blog.iannelson.uk/is-my-string-empty-some-c-performance-metrics/&#34;&gt;quick post from Summer 2004&lt;/a&gt; where I did a quick experiment to &amp;ldquo;prove&amp;rdquo; that in .NET the quickest way of proving that a string is empty is to compare its length to zero.&lt;/p&gt;
&lt;p&gt;Well, as of .NET 2.0, we have a new static method on the System.String class ‚Äì &lt;code&gt;IsNullOrEmpty&lt;/code&gt; ‚Äì that allows you to easily test whether a string is, well, null or empty!&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>The single most popular entry on this blog is, surprisingly enough, this <a href="https://blog.iannelson.uk/is-my-string-empty-some-c-performance-metrics/">quick post from Summer 2004</a> where I did a quick experiment to &ldquo;prove&rdquo; that in .NET the quickest way of proving that a string is empty is to compare its length to zero.</p>
<p>Well, as of .NET 2.0, we have a new static method on the System.String class ‚Äì <code>IsNullOrEmpty</code> ‚Äì that allows you to easily test whether a string is, well, null or empty!</p>
<p>It‚Äôs one of many convenience methods in the .NET 2.0 FCL that tend to get overlooked as developers (perhaps rightly) focus on the big new features such as nullable types, generics, partial classes, etc. I find this method particularly handy when validating parameters passed to publicly-visible methods, as in:</p>
<pre tabindex="0"><code>public void SayHello(string name)  
{    
    if (string.IsNullOrEmpty(name)) throw new ArgumentNullException(&#34;name&#34;);    
    Console.WriteLine(string.Concat(&#34;Hello, &#34;, name));
}
</code></pre><p>It‚Äôs not brain surgery, but it does make the resulting code a little cleaner than in the .NET 1.1 days. Oh, and in case you‚Äôre wondering, here‚Äôs how the method is implemented in System.String (thanks to <a href="http://www.aisto.com/roeder/dotnet">Lutz Roeder‚Äôs Reflector</a>):</p>
<pre tabindex="0"><code>public static bool IsNullOrEmpty(string value)  
{    
    if ( value != null ) 
    { 
        return ( value.Length == 0 );
    }    
    return true;
}
</code></pre><p>More info:</p>
<ul>
<li><a href="http://msdn2.microsoft.com/en-us/library/490acw3e%28vs.80%29.aspx">MSDN documentation</a></li>
<li><a href="http://www.gotdotnet.com/team/fxcop/Docs/Rules/Performance/TestForEmptyStringsUsingStringLength.html">FxCop violation documentation</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>ASP.NET 2.0 ‚Äì one month on</title>
      <link>https://blog.iannelson.uk/asp-net-2-0-one-month-on/</link>
      <pubDate>Sat, 10 Dec 2005 19:12:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/asp-net-2-0-one-month-on/</guid>
      <description>&lt;p&gt;It‚Äôs over a month now since Visual Studio 2005 officially RTM‚Äôd, and during that time I‚Äôve been fortunate enough to have been using it for the majority of my time on most working days. One of the things we‚Äôre trying to achieve is the integration of several distinct internal corporate web applications into a bespoke portal system, with single sign-on, common authorization model, common look and feel, etc. There‚Äôs been quite a heavy R&amp;amp;D / proof-of-concept aspect to the workload so far, as we try out different ways of achieving this, and grow familiar with the new technologies available to us in ASP.NET 2.0.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>It‚Äôs over a month now since Visual Studio 2005 officially RTM‚Äôd, and during that time I‚Äôve been fortunate enough to have been using it for the majority of my time on most working days. One of the things we‚Äôre trying to achieve is the integration of several distinct internal corporate web applications into a bespoke portal system, with single sign-on, common authorization model, common look and feel, etc. There‚Äôs been quite a heavy R&amp;D / proof-of-concept aspect to the workload so far, as we try out different ways of achieving this, and grow familiar with the new technologies available to us in ASP.NET 2.0.</p>
<p>I thought I‚Äôd share with you a few of the links that have been of most help to me over the past month or so:</p>
<ul>
<li><a href="http://weblogs.asp.net/scottgu/">Scott Guthrie‚Äôs Blog</a>. If you develop ASP.NET applications, this is the one site, above all others, to which you should subscribe. Every single one of Scott‚Äôs posts provides extremely useful tips and tricks ‚Äì such as <a href="http://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx">Tips For Nested Master Pages and Design Time</a>, <a href="http://weblogs.asp.net/scottgu/archive/2005/11/18/430943.aspx">How to Change the Default Browser</a> (not obvious, is it?). More importantly, it‚Äôs here that you‚Äôll first learn about VS2005 add-ons such as <a href="http://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx">Web Deployment Projects</a> and the forthcoming new <a href="http://weblogs.asp.net/scottgu/archive/2005/12/07/432630.aspx">Web Project Model</a>.</li>
<li><a href="http://pluralsight.com/blogs/craig/archive/2005/10/19/15696.aspx">Serializing a KeyedCollection</a>. It doesn‚Äôt work, but it‚Äôs not your fault ‚Äì it‚Äôs a bug in the .NET Framework. Had I found this page earlier I would have saved myself multiple hours of frustration.</li>
<li>Another serialization problem that foxed me for a while ‚Äì I had a custom Principal object in a locally referenced assembly. Every time I tried to set my Context.User to an instance of this, I got a SerializationException with a ‚ÄúType is not resolved..‚Äù message. Huh? ¬†More Googling threw up <a href="http://tinyurl.com/7tp97">this post</a> [Google Groups] from Nov 29 explaining the issue and giving some workarounds.</li>
<li><a href="http://weblogs.asp.net/dwahlin/archive/2005/11/16/430779.aspx">Dan Wahlin ‚Äì Sharing Master Pages across IIS Applications</a>. This is *exactly* what we‚Äôve been trying to do ‚Äì Dan‚Äôs post gave us a real leg-up.</li>
<li><a href="http://blogs.msdn.com/davidebb/archive/2005/10/30/487160.aspx">David Ebbo ‚Äì Turning an ascx user control into a redistributable server control</a>. Sounds like a neat trick, although I haven‚Äôt had cause to try it yet.</li>
<li><a href="http://west-wind.com/weblog/posts/3016.aspx">Rich Strahl ‚Äì Understanding Page Inheritance in ASP.NET 2.0</a>. If you‚Äôve got into the habit of dynamically loading user controls into your pages in ASP.NET 1.1, and were planning on doing the same going forward, then you should check out Rick‚Äôs article first. Things aren‚Äôt quite as straightforward as they used to be‚Ä¶</li>
<li><a href="http://msdn.microsoft.com/asp.net/reference/design/default.aspx?pull=/library/en-us/dnaspp/html/aspnetusstan.asp">MSDN: Building ASP.NET 2.0 Web Sites using Web Standards</a>. Don‚Äôt scoff, it‚Äôs an important topic! ¬†I‚Äôve been waiting for valid (X)HTML output from Visual Studio for a long time, I‚Äôm glad to see MS are finally taking standards (and Accessibility) seriously.</li>
<li><a href="http://msdn.microsoft.com/library/default.asp?url=https://blog.iannelson.uk/library/en-us/dnaspp/html/GridViewEx.asp">MSDN: GridView Examples</a>. <a href="http://www.scottonwriting.net/sowBlog/">Scott Mitchell‚Äôs</a> huge (122 page) article explaining how to do anything (well, almost) with the GridView control. Talking of which, you could do worse than also subscribe to Marcie Robillard‚Äôs new site, <a href="http://www.gridviewgirl.com/GridViewGirl/">GridViewGirl</a>.</li>
</ul>
<p>Also, two books which have really helped me get up to speed:</p>
<ul>
<li><a href="http://www.amazon.co.uk/exec/obidos/ASIN/0764559885">Professional .NET Generics</a> ‚Äì a Wrox book (not a huge one, thankfully) on this useful new (to .NET) programming feature.</li>
<li><a href="http://www.amazon.co.uk/exec/obidos/ASIN/0596008120">ASP.NET 2.0 ‚Äì A Developer‚Äôs Notebook</a>. One of those books from the O‚ÄôReilly ‚Äúnotebook‚Äù series that aims to get you up to speed quickly on new features. It works.</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Stopwatch Class for .NET 1.1</title>
      <link>https://blog.iannelson.uk/stopwatch-class-for-net-1-1/</link>
      <pubDate>Tue, 05 Jul 2005 09:07:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/stopwatch-class-for-net-1-1/</guid>
      <description>&lt;p&gt;Paul Welter has backported the System.Diagnostics.Stopwatch class from .NET 2.0 to 1.1. Handy.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://weblogs.asp.net/pwelter34/archive/2005/07/01/416999.aspx&#34;&gt;http://weblogs.asp.net/pwelter34/archive/2005/07/01/416999.aspx&lt;/a&gt;&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Paul Welter has backported the System.Diagnostics.Stopwatch class from .NET 2.0 to 1.1. Handy.</p>
<p><a href="http://weblogs.asp.net/pwelter34/archive/2005/07/01/416999.aspx">http://weblogs.asp.net/pwelter34/archive/2005/07/01/416999.aspx</a></p>
]]></content:encoded>
    </item>
    <item>
      <title>New Recommendations for String Comparisons in .NET 2.0</title>
      <link>https://blog.iannelson.uk/new-recommendations-for-string-comparisons-in-net-2-0/</link>
      <pubDate>Mon, 04 Jul 2005 19:07:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/new-recommendations-for-string-comparisons-in-net-2-0/</guid>
      <description>&lt;p&gt;I know it‚Äôs a rather geeky and dry subject, but I found &lt;a href=&#34;http://msdn.microsoft.com/netframework/default.aspx?pull=/library/en-us/dndotnet/html/StringsinNET20.asp&#34;&gt;this MSDN article on new recommendations for using strings in .NET 2.0&lt;/a&gt; quite interesting. It‚Äôs going to be difficult to stop using CultureInfo.InvariantCulture habitually!&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>I know it‚Äôs a rather geeky and dry subject, but I found <a href="http://msdn.microsoft.com/netframework/default.aspx?pull=/library/en-us/dndotnet/html/StringsinNET20.asp">this MSDN article on new recommendations for using strings in .NET 2.0</a> quite interesting. It‚Äôs going to be difficult to stop using CultureInfo.InvariantCulture habitually!</p>
]]></content:encoded>
    </item>
    <item>
      <title>eXtreme .NET</title>
      <link>https://blog.iannelson.uk/extreme-net/</link>
      <pubDate>Sat, 18 Jun 2005 21:06:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/extreme-net/</guid>
      <description>&lt;p&gt;Up at 0500 yesterday and onto the early GNER Mallard down to that London town for the MSDN briefing on eXtreme programming with .NET. It was pleasant not to be driving for a change, and speeding through the Yorkshire countryside early on a midsummer morning was very relaxing ‚Äì what a stark contrast with the hot crowded tube that I had to catch on arrival to the big smoke. Three stops down to Oxford Circus seemed to last as long as the entire preceeding train journey. How people do this every single day I do not know..&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Up at 0500 yesterday and onto the early GNER Mallard down to that London town for the MSDN briefing on eXtreme programming with .NET. It was pleasant not to be driving for a change, and speeding through the Yorkshire countryside early on a midsummer morning was very relaxing ‚Äì what a stark contrast with the hot crowded tube that I had to catch on arrival to the big smoke. Three stops down to Oxford Circus seemed to last as long as the entire preceeding train journey. How people do this every single day I do not know..</p>
<p>Anyway, I digress. The tech briefing was excellent, a full day‚Äôs set of presentations on eXtreme development practices by the very erudite and engaging <a href="http://www.roodyn.com/">Dr Neil Roodyn</a>, with additional demos by some of the MSDN UK guys. During questioning, nobody in the audience was arguing against using the XP practices espoused, in fact most questioners simply wanted to know how to get project managers and business leaders bought in to the ideas. The general consensus was that suits and customers don‚Äôt want to hear about pair programming and <a href="http://www.testdriven.com/">TDD</a>, they want to see devs working on coding new functionality, which is obviously frustrating for those of us cutting the code. Hopefully sessions like the one on Friday will help to inspire a groundswell of enthusiasm for agile practices amongst developers and team leads which the business leaders will eventually be unable to ignore. Dr Neil suggested that we don‚Äôt try to immediately enforce all 12 XP principles in our workplaces, but start using those which work for us, basically those which we can sneak in under the managements noses!  Nobody can stop you from writing unit tests and adopting a TDD approach to your coding, and may only start asking questions when they see how much more productive you‚Äôre becoming, and how fewer bugs are found in your code. After all, producing quality code is your job, and nobody will stop you from doing your job well.</p>
<hr>
<p>While I remember, some of the books mentioned by Neil were:</p>
<ul>
<li><a href="http://www.amazon.co.uk/exec/obidos/ASIN/0201604566">&ldquo;Software For Your Head&rdquo; by Jim McCarthy</a></li>
<li><a href="http://www.amazon.co.uk/exec/obidos/ASIN/0349113467">&ldquo;The Tipping Point&rdquo; by Malcolm Gladwell</a></li>
<li><a href="http://www.amazon.co.uk/exec/obidos/ASIN/1587991845">&ldquo;Fooled By Randomness&rdquo; by Nassim Nicholas Taleb</a></li>
</ul>
<p>and I have noted down that I should find the time to visit:</p>
<ul>
<li><a href="http://www.microsoft.com/uk/msdn/postevents">http://www.microsoft.com/uk/msdn/postevents</a> ‚Äì for a copy of the slides</li>
<li><a href="http://agilealliance.com">http://agilealliance.com</a></li>
<li><a href="http://www.xpertise.co.uk">http://www.xpertise.co.uk</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Tech Books</title>
      <link>https://blog.iannelson.uk/tech-books/</link>
      <pubDate>Sat, 18 Jun 2005 21:06:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/tech-books/</guid>
      <description>&lt;p&gt;I succumbed to temptation and bought another book at the MSDN briefing yesterday, pausing only out of concern that the guy who mans the &lt;a href=&#34;http://www.computermanuals.co.uk&#34;&gt;Computer Manuals&lt;/a&gt; stand at these events might think that I‚Äôm stalking him (or fancy him!). Having determined that I could hand over my Barclaycard whilst flashing my wedding ring, I brought my current reading list up to three:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.amazon.co.uk/exec/obidos/ASIN/078214361X&#34;&gt;Developer to Designer: GUI Design for the Busy Developer&lt;/a&gt; ‚Äì this was a wedding present from my mother-in-law and is proving to be an interesting, easy-going read so far. My competencies lie in the middle tier and database, and although I‚Äôm technically capable of making GUIs, I prefer to leave the design up to others. It‚Äôs inevitable though that most coders end up doing some design, and this book is, er, designed (sorry) to help with that process. The early section of the book concentrates on each UI element in turn, whilst the later part of the book looks at putting it all together, and has particular focus on the web ‚Äì layout design patterns and interaction patterns. It‚Äôs a good read, making a nice contrast from the heavier books, and I‚Äôm pleased to learn that I‚Äôm not alone in hating Outlook‚Äôs labyrinthine Tools-&amp;gt;Options dialog!&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>I succumbed to temptation and bought another book at the MSDN briefing yesterday, pausing only out of concern that the guy who mans the <a href="http://www.computermanuals.co.uk">Computer Manuals</a> stand at these events might think that I‚Äôm stalking him (or fancy him!). Having determined that I could hand over my Barclaycard whilst flashing my wedding ring, I brought my current reading list up to three:</p>
<p><a href="http://www.amazon.co.uk/exec/obidos/ASIN/078214361X">Developer to Designer: GUI Design for the Busy Developer</a> ‚Äì this was a wedding present from my mother-in-law and is proving to be an interesting, easy-going read so far. My competencies lie in the middle tier and database, and although I‚Äôm technically capable of making GUIs, I prefer to leave the design up to others. It‚Äôs inevitable though that most coders end up doing some design, and this book is, er, designed (sorry) to help with that process. The early section of the book concentrates on each UI element in turn, whilst the later part of the book looks at putting it all together, and has particular focus on the web ‚Äì layout design patterns and interaction patterns. It‚Äôs a good read, making a nice contrast from the heavier books, and I‚Äôm pleased to learn that I‚Äôm not alone in hating Outlook‚Äôs labyrinthine Tools-&gt;Options dialog!</p>
<p><a href="http://www.amazon.co.uk/exec/obidos/ASIN/0321245660">Effective C#: 50 Specific Ways to Improve Your C#</a> ‚Äì another good read that isn‚Äôt too heavy, this is a good book of short hints and tips to dip into when waiting for the latest CTPs of VS and SQL Server to install (well, at least that‚Äôs when I‚Äôve found myself reading it). Depending on your level of experience with C#, you may find some of these suggestions are teaching you to suck eggs, but they all come with detailed justifications that provide useful insights into .NET internals, and out of fifty points you‚Äôre bound to find something that you didn‚Äôt previously know. If you‚Äôre new to C#, get this book now and put it‚Äôs suggestions into practice from the start. If you think you‚Äôre an expert, borrow a copy and use it as a checklist of your knowledge.</p>
<p><a href="http://www.amazon.co.uk/exec/obidos/ASIN/0596007124">Head First Design Patterns</a> ‚Äì this is the book I picked up yesterday (yes, partly because of the cute blonde on the cover), but it was the outstanding content that stopped me putting it down again. This doesn‚Äôt feel like a normal O‚ÄôReilly book, and it feels very far removed from the original Gang of Four‚Äôs Design Patterns book ‚Äì yet it covers the same material. This is a patterns book that won‚Äôt send you to sleep, that will make you laugh, that will make those tricky concepts sink in and your misconceptions float away. It‚Äôs cool, clever, succinct and quite unlike any other tech book I‚Äôve read. The only slight downer is that all the examples are in Java, but this really shouldn‚Äôt be an issue for any half-competent C# developer. Superb.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Framework for Persisting .NET Classes Into SQL Server Image Fields, With Locking Ability</title>
      <link>https://blog.iannelson.uk/framework-for-persisting-net-classes-into-sql-server-image-fields-with-locking-ability/</link>
      <pubDate>Tue, 18 Jan 2005 23:01:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/framework-for-persisting-net-classes-into-sql-server-image-fields-with-locking-ability/</guid>
      <description>&lt;p&gt;There seems to have been a lack of .NET-related stuff on this blog recently, so let me show you something I cobbled together for work purposes last Wednesday:&lt;/p&gt;
&lt;p&gt;A common requirement we have in our ASP.NET applications is how to reliably persist object instances for a lengthy period of time. End users shouldn‚Äôt have to concern themselves with the concept of Session expiry, and it‚Äôs unacceptable for them to return to their PC after nipping off for a coffee to be confronted with the dreaded &amp;ldquo;Object reference not set to an instance of an object&amp;rdquo; when they try to continue editing their basket / sales order / timesheet / whatever.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>There seems to have been a lack of .NET-related stuff on this blog recently, so let me show you something I cobbled together for work purposes last Wednesday:</p>
<p>A common requirement we have in our ASP.NET applications is how to reliably persist object instances for a lengthy period of time. End users shouldn‚Äôt have to concern themselves with the concept of Session expiry, and it‚Äôs unacceptable for them to return to their PC after nipping off for a coffee to be confronted with the dreaded &ldquo;Object reference not set to an instance of an object&rdquo; when they try to continue editing their basket / sales order / timesheet / whatever.</p>
<p>One pattern to solve this, detailed by <a href="http://www.martinfowler.com">Martin Fowler</a> in <a href="http://www.amazon.co.uk/exec/obidos/ASIN/0321127420">Patterns of Enterprise Application Architecture</a>, is the <strong>Serialized LOB</strong> (Large Object), which works by serializing the object in question into binary or text which is then stored in a single database field.</p>
<p>An excellent example of how to achieve this using SQL Server and .NET is given by <a href="http://www.eggheadcafe.com/articles/20020929.asp">Peter A Bromberg in this Egghead Cafe article</a>.</p>
<p>Building on this example, I‚Äôve put together a generic assembly for persisting and retrieving serializable classes into SQL Server, referenced by a combination of two strings (a username and a key). It is essentially an alternative to storing objects in Session or ViewState. As an additional benefit, it allows you to &ldquo;lock&rdquo; objects based on the key, so that only one user can store the same object at a given point in time.</p>
<p>The zip file below includes the source and a SQL script for setting up the required database table and four stored procedures, as well as some unit tests (yes, I am sticking to my New Year‚Äôs Resolution!).</p>
<p>The DataStore class contains the various static methods necessary to add, retrieve and delete objects from the store. For example, to save an object you can simply make a call along the lines of:</p>
<p><code>DataStore.Add(&quot;joebloggs&quot;,&quot;order1234&quot;,objOrder);</code></p>
<p>Note that if an object already exists in the store for a given user/key combination, it will be overwritten.</p>
<p>If you additionally want to ensure that no other users have also stored an object with the same name into the store, pass true into the optional fourth parameter:</p>
<p><code>DataStore.Add(&quot;joebloggs&quot;,&quot;order1234&quot;,objOrder,true);</code></p>
<p>this would throw an ObjectLockedException if any user other than ‚Äújoebloggs‚Äù had previously locked an object called ‚Äúorder1234‚Äù.</p>
<p>To retrieve an object, use the Get method. If the object is not found, this will return null. Otherwise, an instance of PersistedObject will be returned ‚Äì this details information such the datetime at which the object was originally stored and last stored, as well as whether it is locked. The actual object itself is accessible through a &ldquo;StoredObject&rdquo; property.</p>
<p>So, to retrieve the sales order object above from the store, a call would be like this:</p>
<p><code>SalesOrder objOrder = DataStore.Get(&quot;joebloggs&quot;,&quot;order1234&quot;).StoredObject as SalesOrder;</code></p>
<p>That‚Äôs pretty much it. There are also methods to retrieve a collection of objects from the store (GetByUser, GetByKey), as well as methods to remove objects from the store (Remove, RemoveByKey, RemoveByUser, Clear).</p>
<p>Feel free to use and cannibalize this code as you see fit. Let me know if you find it useful or interesting, and of course if you have any suggestions for improvements. Oh, and of course it should go without saying that I make no guarantee as to the suitability of this code for any purpose and accept no responsibility for any loss of data etcetera!</p>
<hr>
<p><strong>Updated 30 October 2005:</strong></p>
<p>I‚Äôve reworked this code for .NET 2.0, and removed the dependency on the Microsoft Data Access Application Block. Also, the NUnit tests have been replaced with VS2005 unit tests.</p>
<p><strong>Updated 17 October 2011:</strong></p>
<p>This project has been <a href="https://github.com/ianfnelson/DataStorage">migrated to GitHub</a>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>A Generic Sorter For Strongly-Typed Collections</title>
      <link>https://blog.iannelson.uk/a-generic-sorter-for-strongly-typed-collections/</link>
      <pubDate>Sun, 07 Nov 2004 21:11:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/a-generic-sorter-for-strongly-typed-collections/</guid>
      <description>&lt;p&gt;Late last night I was doing some development work on a website for our investment club. I had a strongly-typed collection of &amp;ldquo;Stock&amp;rdquo; objects, and wanted to be able to sort them on any parameter (StockName, SharePrice, Volume, MarketCap, etc..) in either descending or ascending order. I didn‚Äôt want to have to write a separate comparer for each property. Reflection to the rescue! Below is a GenericSorter class, the use of which allows for the development of a Sort() method on the collection taking as a parameter the name of the property on which to sort. Smart.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Late last night I was doing some development work on a website for our investment club. I had a strongly-typed collection of &ldquo;Stock&rdquo; objects, and wanted to be able to sort them on any parameter (StockName, SharePrice, Volume, MarketCap, etc..) in either descending or ascending order. I didn‚Äôt want to have to write a separate comparer for each property. Reflection to the rescue! Below is a GenericSorter class, the use of which allows for the development of a Sort() method on the collection taking as a parameter the name of the property on which to sort. Smart.</p>



<script src="https://gist.github.com/ianfnelson/9842860.js"></script>
<p>Bob‚Äôs your uncle.</p>
<p><strong>Update</strong> [2006-02-27]: The above class is no match for some <a href="https://blog.iannelson.uk/universal-comparer-for-net/">much more fully-featured code</a> that was anonymously sent to me earlier this month which allows for sorting on multiple properties to arbitrary depth within the domain object model, using a simple SQL-like syntax. <a href="https://blog.iannelson.uk/universal-comparer-for-net/">Check it out‚Ä¶</a></p>
]]></content:encoded>
    </item>
    <item>
      <title>NHibernate</title>
      <link>https://blog.iannelson.uk/nhibernate/</link>
      <pubDate>Fri, 03 Sep 2004 19:09:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/nhibernate/</guid>
      <description>&lt;p&gt;There‚Äôs &lt;em&gt;so&lt;/em&gt; much good open-source .Net development going on these days ‚Äì .Text, nGallery, nUnit, etc ‚Äì it‚Äôs a really interesting time to be a developer. My colleague Colin just drew my attention to &lt;a href=&#34;http://sourceforge.net/projects/nhibernate&#34;&gt;nHibernate&lt;/a&gt;, an object persistence library for relational databases. &lt;a href=&#34;http://www.theserverside.net/articles/showarticle.tss?id=NHibernate&#34;&gt;TheServerSide.net&lt;/a&gt; has an excellent article summarising its use. Having just finished a long project where a large amount of time was spent writing ‚Äúplumbing‚Äù code to persist objects to and from a SQL Server database, I‚Äôm finding the idea of using an O/R mapper such as this very appealing the next time round. Just as incorporating the &lt;a href=&#34;http://msdn.microsoft.com/library/default.asp?url=https://blog.iannelson.uk/library/en-us/dnbda/html/daab-rm.asp&#34;&gt;MS DAAB block&lt;/a&gt; into solutions has reduced the amount of data access code required, I‚Äôm hopeful that embracing frameworks such as nHibernate will leave us with more time to spend focusing on addressing the business needs and less on re-solving technical issues.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>There‚Äôs <em>so</em> much good open-source .Net development going on these days ‚Äì .Text, nGallery, nUnit, etc ‚Äì it‚Äôs a really interesting time to be a developer. My colleague Colin just drew my attention to <a href="http://sourceforge.net/projects/nhibernate">nHibernate</a>, an object persistence library for relational databases. <a href="http://www.theserverside.net/articles/showarticle.tss?id=NHibernate">TheServerSide.net</a> has an excellent article summarising its use. Having just finished a long project where a large amount of time was spent writing ‚Äúplumbing‚Äù code to persist objects to and from a SQL Server database, I‚Äôm finding the idea of using an O/R mapper such as this very appealing the next time round. Just as incorporating the <a href="http://msdn.microsoft.com/library/default.asp?url=https://blog.iannelson.uk/library/en-us/dnbda/html/daab-rm.asp">MS DAAB block</a> into solutions has reduced the amount of data access code required, I‚Äôm hopeful that embracing frameworks such as nHibernate will leave us with more time to spend focusing on addressing the business needs and less on re-solving technical issues.</p>
<p>If anyone has had experience of using nHibernate or similar O/R mapper in an enterprise .NET project, I‚Äôd be interesting in hearing your opinions. Would you use it again? Did it genuinely help to abstract away the object persistence/retrieval mechanisms from the domain model, or is it just one more layer to worry about and keep up to date? Let me know.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Is My String Empty?  Some C# Performance Metrics</title>
      <link>https://blog.iannelson.uk/is-my-string-empty-some-c-performance-metrics/</link>
      <pubDate>Fri, 30 Jul 2004 10:07:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/is-my-string-empty-some-c-performance-metrics/</guid>
      <description>&lt;p&gt;&lt;strong&gt;Update (25/02/2006)&lt;/strong&gt; ‚Äì Hey, we now have &lt;a href=&#34;https://blog.iannelson.uk/string-isnullorempty/&#34;&gt;String.IsNullOrEmpty&lt;/a&gt;, you know!&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;What‚Äôs the quickest way, in C#, to test whether a string is empty? This is a question which came to my mind yesterday. I‚Äôve always been fond of:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;if (myString==String.Empty)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;but it occured to me that this necessitates the creation and destruction of a second object (the empty string with which we‚Äôre comparing), so maybe it would be quicker to write:&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p><strong>Update (25/02/2006)</strong> ‚Äì Hey, we now have <a href="https://blog.iannelson.uk/string-isnullorempty/">String.IsNullOrEmpty</a>, you know!</p>
<hr>
<p>What‚Äôs the quickest way, in C#, to test whether a string is empty? This is a question which came to my mind yesterday. I‚Äôve always been fond of:</p>
<p><code>if (myString==String.Empty)</code></p>
<p>but it occured to me that this necessitates the creation and destruction of a second object (the empty string with which we‚Äôre comparing), so maybe it would be quicker to write:</p>
<p><code>if (myString.Length==0)</code></p>
<p>And looking through some existing code I also found examples of:</p>
<p><code>if String.Equals(myString,String.Empty)</code></p>
<p>I decided that an experiment was in order, so wrote a quick windows application to try each method in turn. I was also interested to see if there was a difference in performance where the result was true than when it was false.</p>
<p>Here are the results, with times in milliseconds for 50 million iterations:</p>
<table>
  <thead>
      <tr>
          <th></th>
          <th>true result</th>
          <th>false result</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>myString==String.Empty</code></td>
          <td>1172</td>
          <td>2484</td>
      </tr>
      <tr>
          <td><code>myString.Length==0</code></td>
          <td>531</td>
          <td>531</td>
      </tr>
      <tr>
          <td><code>String.Equals(myString,String.Empty)</code></td>
          <td>611</td>
          <td>1893</td>
      </tr>
  </tbody>
</table>
<p>So there you have it. Experimental evidence that the fastest way to test for an empty string is to test whether it‚Äôs Length property is zero (and that this also takes exactly the same length of time irrespective of whether the result is true or false).. unless anyone knows of a quicker method? Of course, since we‚Äôre only saving ourselves around 50 nanoseconds per iteration against using the slowest method shown above, this is hardly going to result in a noticeable performance gain!!</p>
]]></content:encoded>
    </item>
    <item>
      <title>Inheriting From BaseValidator to Make Custom Validation Controls</title>
      <link>https://blog.iannelson.uk/inheriting-from-basevalidator-to-make-custom-validation-controls/</link>
      <pubDate>Wed, 30 Jun 2004 19:06:00 +0000</pubDate>
      <guid>https://blog.iannelson.uk/inheriting-from-basevalidator-to-make-custom-validation-controls/</guid>
      <description>&lt;p&gt;For months now, I‚Äôve been desperate for a decent excuse to make a custom ASP.NET server control, so I was secretly pleased today when a CustomValidator originally coded for use on a single page was required elsewhere.&lt;/p&gt;
&lt;p&gt;It‚Äôs surprisingly easy to do, although it took me a while to find a decent example online, which eventually came courtesy of the &lt;a href=&#34;http://www.4guysfromrolla.com/webtech/tips/t040302-1.shtml&#34;&gt;4GuysFromRolla&lt;/a&gt;. In my particular scenario, I needed to check that the text entered into a TextBox did not equal any of a selection of &amp;ldquo;banned&amp;rdquo; strings (which was available via a static property on another class).&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>For months now, I‚Äôve been desperate for a decent excuse to make a custom ASP.NET server control, so I was secretly pleased today when a CustomValidator originally coded for use on a single page was required elsewhere.</p>
<p>It‚Äôs surprisingly easy to do, although it took me a while to find a decent example online, which eventually came courtesy of the <a href="http://www.4guysfromrolla.com/webtech/tips/t040302-1.shtml">4GuysFromRolla</a>. In my particular scenario, I needed to check that the text entered into a TextBox did not equal any of a selection of &ldquo;banned&rdquo; strings (which was available via a static property on another class).</p>
<p>Having added a new custom web control, deriving from BaseValidator, my first task was therefore to ensure that the control being validated really was a TextBox ‚Äì this was done by overriding the <code>ControlPropertiesValid()</code> method:</p>



  

<script src="https://gist.github.com/ianfnelson/9842442.js?file=ControlPropertiesValid.cs"></script>
<p>That done, I just had to override the <code>EvaluateIsValid()</code> method, which does the actual validation:</p>



  

<script src="https://gist.github.com/ianfnelson/9842442.js?file=EvaluateIsValid.cs"></script>
<p>&hellip;and that was it. Job done, pretty much. OK, so I spent a while making a cute icon image too. But the coding was easy and straightforward ‚Äì inheriting from BaseValidator meant that most of the work was already done for me. In no time at all I was able to drop this custom control onto the required pages and user controls.</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
