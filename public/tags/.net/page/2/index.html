<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>.NET | Ian Nelson</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="https://blog.iannelson.uk/tags/.net/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.507965cef202c8ad6ac74222b0ed770dc0aaeab2c82c87ebdbd46b4f8b3196e2.css" integrity="sha256-UHllzvICyK1qx0IisO13DcCq6rLILIfr29RrT4sxluI=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blog.iannelson.uk/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.iannelson.uk/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.iannelson.uk/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.iannelson.uk/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.iannelson.uk/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://blog.iannelson.uk/tags/.net/index.xml">
<link rel="alternate" hreflang="en" href="https://blog.iannelson.uk/tags/.net/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-5JMKSPFQKQ"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-5JMKSPFQKQ');
        }
      </script><meta property="og:url" content="https://blog.iannelson.uk/tags/.net/">
  <meta property="og:site_name" content="Ian Nelson">
  <meta property="og:title" content=".NET">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=".NET">
<meta name="twitter:description" content="">

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.iannelson.uk/" accesskey="h" title="Ian Nelson (Alt + H)">Ian Nelson</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.iannelson.uk/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://blog.iannelson.uk/testimonials" title="Testimonials">
                    <span>Testimonials</span>
                </a>
            </li>
            <li>
                <a href="https://blog.iannelson.uk/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://blog.iannelson.uk/categories" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://blog.iannelson.uk/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>
    .NET
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">WCF ‚Äì NHibernate Unit Of Work Endpoint Behavior
    </h2>
  </header>
  <div class="entry-content">
    <p>OK, my last WCF-related code snippet of the day, I promise. This is quite similar to the last one. I required that the WCF service I was developing started a new NHibernate Session for each invocation, and closed it after invocation (i.e. session-per-request). I couldn‚Äôt rely on the ASP.NET session start and end events in global.asax as this particular WCF service was to respond to MSMQ messages rather than HTTP.
...</p>
  </div>
  <footer class="entry-footer"><span title='2010-04-09 13:04:00 +0000 +0000'>9 April 2010</span></footer>
  <a class="entry-link" aria-label="post link to WCF ‚Äì NHibernate Unit Of Work Endpoint Behavior" href="https://blog.iannelson.uk/wcf-nhibernate-unit-of-work-endpoint-behavior/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">An MVC Gotcha and the PRG Pattern
    </h2>
  </header>
  <div class="entry-content">
    <p>If you‚Äôve recently moved across to ASP.NET MVC development following years of wrangling with the leaky abstraction that was WebForms, you may have encountered some seemingly curious behaviour when posting back to the same URL.
Suppose we have the following simple, contrived and utterly imagination-free model:
Here‚Äôs a view:
And here‚Äôs the controller:
Note that we have two separate Index actions ‚Äì one for HTTP GET which instantiates and displays a new FooModel instance, and one for HTTP POST which modifies one of the properties on the posted FooModel instance before re-rendering the view.
...</p>
  </div>
  <footer class="entry-footer"><span title='2010-04-09 10:04:00 +0000 +0000'>9 April 2010</span></footer>
  <a class="entry-link" aria-label="post link to An MVC Gotcha and the PRG Pattern" href="https://blog.iannelson.uk/an-mvc-gotcha-and-the-prg-pattern/"></a>
</article>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2009/10/iStock_000010551634XSmall_3-1.jpg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">A Circuit Breaker Which Trips On Frequency Of Failures
    </h2>
  </header>
  <div class="entry-content">
    <p>@Jez tweeted last night:
@ianfnelson admit it: you use Castle Windsor primarily to highlight and lampoon Google‚Äôs poor selection of adwords?!
‚Äî ùöÇùöëùöòùöòùöùùöíùöóùöê ùöÇùöåùöíùöïùöïùö¢ (@shootingscilly) October 26, 2009
Funny, but not true. I am enamoured with the Castle Windsor project because its power makes it fairly simple for me to develop loosely-coupled systems which are easily maintained and tested. The wide range of Facilities and Contrib projects also integrate nicely with the other parts of my current development stack (NHibernate, WCF, WF, log4net).
...</p>
  </div>
  <footer class="entry-footer"><span title='2009-10-28 11:10:00 +0000 GMT'>28 October 2009</span></footer>
  <a class="entry-link" aria-label="post link to A Circuit Breaker Which Trips On Frequency Of Failures" href="https://blog.iannelson.uk/a-circuit-breaker-which-trips-on-frequency-of-failures/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Castle Windsor Array Resolution Gotcha
    </h2>
  </header>
  <div class="entry-content">
    <p>The shiny new system which I‚Äôve recently been developing makes heavy use of the Chain of Responsibility pattern, and as such a number of service classes take an array of objects in the constructor:
I‚Äôm using Castle Windsor for dependency management, so I‚Äôve been fluently registering all instances of ILeadAllocator:
Easy, right? And yet at runtime Windsor surprised me by throwing this exception in my face:
Castle.MicroKernel.Handlers.HandlerException: Can‚Äôt create component &amp;#8216;Marshalls.Leads.ApplicationService.LeadAllocationService‚Äô as it has dependencies to be satisfied. Marshalls.Leads.ApplicationService.LeadAllocationService is waiting for the following dependencies: Keys (components with specific keys) ‚Äì leadAllocators which was not registered. Huh?! What gives? Well, a little Googling revealed this post from Castle founder Hamilton Verissimo explaining that by default the Castle MicroKernel expects me to define what should be included in the array. But he goes on to explain that the behaviour I desire can be achieved by registering a custom subresolver with the microkernel. That subresolver has since been included in the Castle Windsor distro, so in actual fact all I needed to do was add the following line of code when configuring my container:
...</p>
  </div>
  <footer class="entry-footer"><span title='2009-10-26 10:10:00 +0000 GMT'>26 October 2009</span></footer>
  <a class="entry-link" aria-label="post link to Castle Windsor Array Resolution Gotcha" href="https://blog.iannelson.uk/castle-windsor-array-resolution-gotcha/"></a>
</article>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2009/10/iStock_000000942732XSmall_2-1.jpg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Castle Windsor Lifestyle Gotcha
    </h2>
  </header>
  <div class="entry-content">
    <p>I always knew my lifestyle choices would come back to bite me some day‚Ä¶
I‚Äôve been making heavy use of the Castle Windsor container to handle dependency and configuration management in the shiny new system that I‚Äôm currently developing. For the most part it‚Äôs been an absolute blast, allowing me to easily create a loosely-coupled system architecture and focus my efforts on what the system should be achieving for the client, rather than worrying about how it all hangs together.
...</p>
  </div>
  <footer class="entry-footer"><span title='2009-10-19 05:10:00 +0000 +0000'>19 October 2009</span></footer>
  <a class="entry-link" aria-label="post link to Castle Windsor Lifestyle Gotcha" href="https://blog.iannelson.uk/castle-windsor-lifestyle-gotcha/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Alt.Net UK In The North
    </h2>
  </header>
  <div class="entry-content">
    <p>I spent much of this weekend over in Bradford, talking shop with the good folks at the Alt.Net UK ‚Äòin the North‚Äô conference. I had a great time, learned much, and am grateful to Richard Fennell of Black Marble and the other organisers and sponsors for making the event possible.
This was the first Open Spaces event I‚Äôve attended, and I was pleasantly surprised at how orderly and productive the sessions turned out to be. Unlike conventional sales-pitch conferences of the MSDN roadshow variety, this was more of an open forum, with an expectation that all of the relatively small number (25ish?) of participants would, well, participate!
...</p>
  </div>
  <footer class="entry-footer"><span title='2009-04-19 20:04:00 +0000 +0000'>19 April 2009</span></footer>
  <a class="entry-link" aria-label="post link to Alt.Net UK In The North" href="https://blog.iannelson.uk/alt-net-uk-in-the-north/"></a>
</article>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2009/03/iStock_000003255884XSmall_3-1.jpg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">ASP.NET Just Became a Legacy Platform
    </h2>
  </header>
  <div class="entry-content">
    <p>One of the least surprising but more significant announcements to come out of Mix ‚Äò09 last week was the general availability of ASP.NET MVC 1.0. The development process for this framework has been very transparent, with no fewer than eight previews, betas and release candidates made available over the past year or so.
Microsoft are being careful to tout ASP.NET MVC as being ‚Äúan alternative, not a replacement, for ASP.NET Web Forms‚Äù, but just look at their list of some of its benefits:
...</p>
  </div>
  <footer class="entry-footer"><span title='2009-03-22 21:03:00 +0000 GMT'>22 March 2009</span></footer>
  <a class="entry-link" aria-label="post link to ASP.NET Just Became a Legacy Platform" href="https://blog.iannelson.uk/asp-net-just-became-a-legacy-platform/"></a>
</article>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2009/02/iStock_000002131299XSmall_3-1.jpg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">NDepend
    </h2>
  </header>
  <div class="entry-content">
    <p>OK, dear readers, today I‚Äôd like to talk about tools.
Software development isn‚Äôt really so different from traditional skilled crafts in that it is important to have an understanding of the tools available to help you create a quality products in the least amount of time possible.
For .NET developers, the Visual Studio IDE is usually just the starting point, and most of us will come to rely on some of the tools listed in Scott Hanselman‚Äôs famous tools list. Personally, I can‚Äôt imagine coding without first installing Refactor Pro, editing text files in anything other than TextPad, or working on a machine that doesn‚Äôt have Snag It installed.
...</p>
  </div>
  <footer class="entry-footer"><span title='2009-02-04 15:02:00 +0000 GMT'>4 February 2009</span></footer>
  <a class="entry-link" aria-label="post link to NDepend" href="https://blog.iannelson.uk/ndepend/"></a>
</article>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://blogstouks01.z33.web.core.windows.net/2009/01/iStock_000004478097XSmall_2-1.jpg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">.NET Coding Standards
    </h2>
  </header>
  <div class="entry-content">
    <p>Sometimes, when you join a new team as a .NET developer, the team lead proudly points you in the direction of a Word document or wiki page detailing the team‚Äôs house coding standards.
In my experience, these documents are invariably:
Incomplete. Subjective. Not enforced. Largely copied from the interweb. Obsessed with the trivial (e.g. whitespace) while failing to mention the genuinely useful (e.g. boxing/unboxing, avoiding use of deprecated classes, Dispose pattern, etc). I know this because I‚Äôve been involved in creating such documents in the past üôÇ
...</p>
  </div>
  <footer class="entry-footer"><span title='2009-01-23 15:01:00 +0000 GMT'>23 January 2009</span></footer>
  <a class="entry-link" aria-label="post link to .NET Coding Standards" href="https://blog.iannelson.uk/net-coding-standards/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">MSB3247 ‚Äì Dependent Assembly Conflicts
    </h2>
  </header>
  <div class="entry-content">
    <p>Earlier today a dev came over to ask me about a compiler warning he was getting when building a .NET solution:
MSB3247: Found conflicts between different versions of the same dependent assembly.
This is basically telling you that one project or dependency in your solution is referencing one version of an assembly, whilst another project or dependency is trying to reference a different version of the same assembly. Unhelpfully, the message and build output don‚Äôt tell you which dependent assembly is causing the problem!
...</p>
  </div>
  <footer class="entry-footer"><span title='2008-12-04 21:12:00 +0000 GMT'>4 December 2008</span></footer>
  <a class="entry-link" aria-label="post link to MSB3247 ‚Äì Dependent Assembly Conflicts" href="https://blog.iannelson.uk/msb3247-dependent-assembly-conflicts/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Performance of Loops on Collections
    </h2>
  </header>
  <div class="entry-content">
    <p>Interesting article from Patrick Smacchia (the NDepend guy) in which he runs some benchmarks on the cost of looping in different ways over different constructs and comes to the conclusion that:
‚Äúlooping on array using for is 5 times cheaper than looping on List&lt;T&gt; using foreach (which I believe, is what we all do)‚Äù
Well worth a read, although I suspect that in my solutions the bottlenecks will remain the out-of-process calls, i.e. database access and web service calls. Still, a 5x gain is not to be sniffed at.
...</p>
  </div>
  <footer class="entry-footer"><span title='2008-11-28 12:11:00 +0000 GMT'>28 November 2008</span></footer>
  <a class="entry-link" aria-label="post link to Performance of Loops on Collections" href="https://blog.iannelson.uk/performance-of-loops-on-collections/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">A LINQ Gotcha ‚Äì First Operator
    </h2>
  </header>
  <div class="entry-content">
    <p>So, I was using the First operator to return the first item element in a sequence matching a predicate.
I expected a null to be returned if the sequence did not contain any matching elements, but found (well, Scott found) that this actually throws an InvalidOperationException.
Turns out I should have been using the FirstOrDefault operator instead‚Ä¶
</p>
  </div>
  <footer class="entry-footer"><span title='2007-12-14 14:12:00 +0000 GMT'>14 December 2007</span></footer>
  <a class="entry-link" aria-label="post link to A LINQ Gotcha ‚Äì First Operator" href="https://blog.iannelson.uk/a-linq-gotcha-first-operator/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">MSDN Technical Roadshow 2007
    </h2>
  </header>
  <div class="entry-content">
    <p>I‚Äôm off to the MSDN Technical roadshow in Harrogate tomorrow, and am actually really looking forward to it this time. These events are free, so always well worth attending when they‚Äôre local, but some years are certainly better than others ‚Äì it mostly depends on the material being covered. I remember one year circa 2003-4, when .NET was well established, but before the Whidbey release, so the majority of the day was effectively just a sales pitch covering elementary .NET concepts, presumably for those laggards who hadn‚Äôt yet made the great leap from VB6. Another data-binding demo, anybody? Yawn.
...</p>
  </div>
  <footer class="entry-footer"><span title='2007-03-12 22:03:00 +0000 GMT'>12 March 2007</span></footer>
  <a class="entry-link" aria-label="post link to MSDN Technical Roadshow 2007" href="https://blog.iannelson.uk/msdn-technical-roadshow-2007/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">A Serializable KeyValuePair Class
    </h2>
  </header>
  <div class="entry-content">
    <p>Having accepted that Returning DataSets from WebServices is the Spawn of Satan and Represents All That Is Truly Evil in the World (or at least, not exactly best practice), I‚Äôve been trying to make a conscious effort to instead use lightweight custom objects in my middle tier, to be exposed via web services for use by other applications. I felt sure that some of the new Generic classes in the .NET 2.0 FCL would help me in my quest. Specifically, as I often need to expose simple arrays of Key/Value Pair metadata, I planned to create an instance of the System.Collections.ObjectModel.Collection class, containing a bunch of System.Collections.Generic.KeyValuePair objects.
...</p>
  </div>
  <footer class="entry-footer"><span title='2006-09-17 17:09:00 +0000 +0000'>17 September 2006</span></footer>
  <a class="entry-link" aria-label="post link to A Serializable KeyValuePair Class" href="https://blog.iannelson.uk/a-serializable-keyvaluepair-class/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Big Integer
    </h2>
  </header>
  <div class="entry-content">
    <p>As I mentioned last summer, I do enjoy whiling away a few hours attempting to solve the maths / progamming challenges set on Project Euler. My language of choice for most puzzles is C#, but this hampered me on some of the questions as there is no in-built support for really big integers.
However, a little bit of Googling and I came across this excellent BigInteger class on Code Project which does everything I need and more ‚Äì and it seems bloody fast, too. Thanks to this class, I‚Äôve been able to knock off several more problems this weekend, and now have a rating of ‚Äú11% Genius‚Äù ‚Äì still some way to go, then‚Ä¶
...</p>
  </div>
  <footer class="entry-footer"><span title='2006-07-17 08:07:00 +0000 +0000'>17 July 2006</span></footer>
  <a class="entry-link" aria-label="post link to Big Integer" href="https://blog.iannelson.uk/big-integer/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://blog.iannelson.uk/tags/.net/">
      ¬´&nbsp;Prev&nbsp;
    </a>
    <a class="next" href="https://blog.iannelson.uk/tags/.net/page/3/">Next&nbsp;&nbsp;¬ª
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://blog.iannelson.uk/">Ian Nelson</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
